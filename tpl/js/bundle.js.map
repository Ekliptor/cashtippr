{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/AbstractModule.ts","webpack:///./src/CashTippr.ts","webpack:///./index.ts","webpack:///./src/admin/Tooltips.ts","webpack:///./src/WebHelpers.ts","webpack:///./src/BlurryImage.ts","webpack:///./src/Shout.ts","webpack:///./src/QrCode.ts","webpack:///./src/BadgerWallet.ts","webpack:///./src/SlpPress.ts","webpack:///./src/FingerPrint.ts","webpack:///./src/structs/SlpAddress.ts","webpack:///./src/Woocommerce.ts","webpack:///./src/structs/Order.ts","webpack:///./src/AdBlockDetect.ts","webpack:///./src/admin/AdminControls.ts","webpack:///./src/SlpSDK.ts","webpack:///./src/structs/ReaderTokens.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","cashtippr","webHelpers","this","getWebHelpers","AbstractModule","window","$","config","addDefaultConfig","WebHelpers","tooltips","Tooltips","adminControls","AdminControls","badger","BadgerWallet","qr","QrCode","adBlockDetect","AdBlockDetect","blurryImage","BlurryImage","shout","Shout","woocommerce","Woocommerce","slpPress","SlpPress","document","ready","adminConfig","setConfig","init","checkCookieConsent","toSatoshis","bch","Math","floor","getConfig","getAdminConfig","getTooltips","getBadgerWallet","getPluginPaymentID","paymentControlsWrapper","attr","replace","addCopyInputListeners","click","event","preventDefault","inputEl","target","parent","find","select","execCommand","err","isAppleIOS","addClass","consentCookieName","CashTippr","CONSENT_COOKIE_NAME","confirmCookiesMsg","CONFIRM_COOKIES_MSG","confirmCookiesBtn","CONFIRM_COOKIES_BTN","jQuery","initToolTips","e","that","tsfL10n","debug","touchBuffer","inTouchBuffer","setEvents","unset","touchEvents","$target","off","body","on","mouseMove","mouseLeave","touchRemove","updateDesc","classList","contains","tooltipText","querySelector","Element","innerHTML","dataset","desc","$tooltip","$arrow","overflow","data","overflowDir","parseInt","isNaN","round","css","pagex","originalEvent","pageX","$hoverItemWrap","closest","mousex","offset","left","arrowWidth","$textWrap","textWrapWidth","outerWidth","adjust","adjustDir","boundaryRight","arrowBoundary","remove","clearTimeout","setTimeout","$keepBalloon","hasClass","$children","children","length","not","loadToolTip","isTouch","type","$hoverItem","title","append","$boundary","tooltipHeight","outerHeight","tooltipTop","top","prop","$innerText","hoverItemWrapWidth","width","textWidth","textLeft","textRight","boundaryLeft","horIndent","basis","indent","right","mouseEnter","item","_event","Event","console","log","trigger","stopPropagation","initTooltips","$wrap","addTooltipBoundary","_triggerTooltipReset","_triggerTooltipUpdate","cssSelectors","getBrowserLang","navigator","language","substr","toLowerCase","getCookie","c_name","x","y","ARRcookies","cookie","split","indexOf","decodeURI","setCookie","expireDays","date","Date","getTime","cookieLifeDays","toUTCString","cookiePath","removeCookie","confirmCookies","fromBase64","atob","error","toBase64","btoa","translate","text","variables","safeHtml","toString","start","end","charAt","placeHolder","substring","translation","tr","textPiece","escapeOutput","reg","RegExp","match","convertNewlines","escapeRegex","str","args","arguments","test","userAgent","MSStream","getAllCssSelectors","cached","originRegex","location","origin","styleSheets","sheet","href","rules","u","selectorText","push","imports","isExistingCssSelector","selector","selectors","getApi","path","callback","dataType","undefined","url","siteUrl","textStatus","jqXHR","postApi","post","postApiJson","outData","JSON","stringify","scheduleUpdateTimerID","updateRemainingChars","addEventListeners","addConfirmDeleteMessages","onPayment","payment","domID","submit","forms","each","index","formEl","val","remaining","fadeOut","fadeIn","keyup","scheduleCharsUpdate","change","question","confirm","showQrDialog","paymentButtonWrapper","txid","paymentCtrlWrapper","amount","params","am","dialog","html","dialog_class","errorMsg","globalCallbacks","onBadgerPayment","sendPaymentReceived","updateButtonAmount","isInstalled","web4bch","isLoggedIn","wnd","defaultAccount","getDefaultAddress","getDefaultSlpAddress","defaultSlpAccount","buttonData","buttonDataObj","parse","buttonId","show_search_engines","ajaxConfirm","days","postHide","res","reload","open","INSTALL_URL","alert","badgerLocked","sendPayment","button","Web4Bch","currentProvider","btn","txParams","to","from","sendTransaction","keep","keepTransaction","btnContainer","amountNewUserCurrency","parseFloat","Number","NaN","currency","display_currency","amountSats","rate","distributeTokens","fingerPrint","FingerPrint","checkTokens","timeSec","startSendingTokens","slpAddress","conf","badgerWallet","receivedHtml","walletReceived","ticker","address","showTokenInfo","getTokenInfoLink","askHtml","enterWallet","askUserWallet","unlockBadger","badgerReceived","message","showReload","showClose","tokenMsg","barHeight","getWpAdminbarHeight","style","askWallet","slpWallet","SlpAddress","isValidSlpAddress","invalidAddress","height","linkHtml","icon","website","moreInfo","iconSrc","userID","fingerprint","getCanvasFingerPrint","badgerSlpAddress","testCanvas","getElementById","ctx","getContext","txt","textBaseline","font","fillStyle","fillRect","fillText","b64","toDataURL","binImage","bin2hex","slice","charCodeAt","isValidBchAddress","bchAddress","trim","addressParts","fullyPaid","checkServerPaymentTimerID","addButtonLinkClass","checkPaymentIntervalSec","checkPaymentStatus","addPaymentFormEvents","eq","sendPaymentForValidation","firstButton","dbtxid","assign","paymentFormEl","repeat","nonce","orderID","oid","order","Order","status","showPaymentReceived","bchAmountReceived","showPartialPayment","numDecimals","paymentCommaDigits","remainingAmount","calculateRemaningAmount","toFixed","qrcode","uri","paidTxt","buttons","max","bchAmount","detect_adblock","tipAmount","loadLib","adblockNoConflict","fuckAdBlock","FuckAdBlock","importFAB","createElement","onload","checkOnLoad","resetOnEnd","loopCheckTime","loopMaxNumber","baitClass","baitStyle","onDetected","onAdBlockDetected","onNotDetected","onAdBlockNotDetected","onerror","integrity","crossOrigin","src","adBlockScript","head","appendChild","secondTry","loadAdFrame","ctipAdblockDetected","disablePage","adblockDisable","msg","postTitle","postContent","content","loadedAdFrame","importScript","ctipAdblockOk","adFrameBaitUrl","slpSDK","distributingTokens","queryPayoutsTimerID","walletImportOpen","enableAdblockSettings","enableSlpPressForPosts","SlpSDK","toggleWalletCreateControls","toggleSendingTokenState","adminSlpWallet","displayWalletBalance","displayBchWalletBalance","isTokenConfigured","createWallet","configureToken","fadeToggle","removeProp","importWallet","confirmDeleteWallet","deleteWallet","scheduleQueryTokenDistribution","laavePage","unbind","adblockSettingsSelector","is","checkboxElement","pages","settingsSelector","wallet","storeWallet","addressSlp","mnemonic","passphrase","loginToWallet","invalidPassphrase","getWalletAddresses","addresses","admin","addressBch","importOk","getTokenBalance","id","balance","amountLow","getBalance","BCH_BALANCE_LOW","Promise","resolve","reject","token","sendTokens","tokens","errors","addLogLine","sendToken","notifyTokenSent","Error","auth","slpDistributeNonce","queryTokenDistribution","ReaderTokens","fromJson","fail","delayMs","QUERY_TOKEN_INTERVAL_MS","line","lineBreak","scrollTop","scrollHeight","mnemonicLanguage","testnet","restUrl","className","constructor","slp","ekliptor","blockchainAPI","SLP","restURL","Blockchain","getBlockchainInfo","then","result","catch","Mnemonic","generate","wordLists","rootSeed","toSeed","masterHDNode","HDNode","fromSeed","addrsses","addrssesSlp","CREATE_ADDRESS_COUNT","childNode","derivePath","toCashAddress","toSLPAddress","addressList","addressListSlp","CHECK_ADDRESS_COUNT","numberAddresses","getBalanceByKey","cashAddress","Address","details","tokenID","Utils","balancesForAddress","Array","isArray","tokenId","toSlpAddress","tokenAmount","account","fundingAddress","fundingWif","toWIF","sendConfig","tokenReceiverAddress","bchChangeReceiverAddress","TokenType1","send","json"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","import {CashTippr} from \"./CashTippr\";\nimport {WebHelpers} from \"./WebHelpers\";\n\n\nexport class AbstractModule {\n    protected cashtippr: CashTippr;\n    protected webHelpers: WebHelpers;\n\n    constructor(cashtippr: CashTippr, webHelpers: WebHelpers = null) {\n        this.cashtippr = cashtippr;\n        this.webHelpers = webHelpers ? webHelpers : this.cashtippr.getWebHelpers();\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n}\n","import {Tooltips} from \"./admin/Tooltips\";\nimport {WebHelpers, WebHelpersConfig} from \"./WebHelpers\";\nimport {BlurryImage} from \"./BlurryImage\";\nimport {Shout} from \"./Shout\";\nimport {QrCode} from \"./QrCode\";\nimport {BadgerWallet} from \"./BadgerWallet\";\nimport {SlpPress, SlpPressConfig} from \"./SlpPress\";\nimport {Woocommerce} from \"./Woocommerce\";\nimport {AdBlockDetect} from \"./AdBlockDetect\";\nimport {AdminControls} from \"./admin/AdminControls\";\n\nexport interface BitcoinCashConversionRate {\n    [fiatCurrency: string]: number;\n}\nexport interface CashTipprConfig extends WebHelpersConfig {\n    // same keys as in php\n    show_search_engines: boolean;\n    display_currency: string;\n    rate: BitcoinCashConversionRate;\n    ajaxConfirm?: boolean;\n    keepTransaction?: boolean; // keep the transaction in mysql so that plugin addons can use them after payment\n    paymentCommaDigits: number;\n\n    detect_adblock: boolean;\n    adblockDisable: boolean;\n    adBlockScript: string;\n    adblockNoConflict: boolean;\n    adFrameBaitUrl: string;\n    tipAmount: number;\n\n    // SLP Press\n    distributeTokens?: SlpPressConfig;\n\n    // present after order is placed\n    orderID?: number;\n    nonce?: string;\n    checkPaymentIntervalSec: number;\n\n    // localizations\n    badgerLocked: string;\n    paidTxt: string;\n}\n\nexport interface CashTipprAdminConfig extends WebHelpersConfig {\n    //loadBlockchainApi: boolean;\n    adminSlpWallet?: string;\n    slpDistributeNonce?: string;\n\n    // localizations\n    distributeTokens?: SlpPressConfig;\n}\n\nexport interface AbstractPayment {\n    domID: string; // the full ID of the wrapper div for the payment control\n    txid: string; // the blockchain transaction ID/hash\n    amount: number; // the amount in the website's currency (USD,...)\n}\n\nexport interface CashtipprApiRes {\n    error: boolean;\n    errorMsg: string;\n    data: any[];\n}\n\nexport class CashTippr {\n    protected static readonly CONSENT_COOKIE_NAME = \"ct-ck\";\n    protected static readonly CONFIRM_COOKIES_MSG = \"#ct-cookieMsg\";\n    protected static readonly CONFIRM_COOKIES_BTN = \"#ct-confirmCookies\";\n    // TODO separate entryPoints + classes for admin + public code? but tooltips and other admin stuff can be used publicly too (and is quite small)\n\n    public readonly window: Window;\n    public readonly $: JQueryStatic;\n    public readonly badger: BadgerWallet;\n    public readonly qr: QrCode;\n    public readonly adBlockDetect: AdBlockDetect;\n    public readonly blurryImage: BlurryImage;\n    public readonly shout: Shout;\n    public readonly woocommerce: Woocommerce;\n    public readonly slpPress: SlpPress;\n\n    protected config: CashTipprConfig;\n    protected adminConfig:CashTipprAdminConfig;\n    protected webHelpers: WebHelpers;\n    protected adminControls: AdminControls;\n    protected tooltips: Tooltips;\n\n    constructor(window: Window, $: JQueryStatic) {\n        this.window = window;\n        this.$ = $;\n        this.config = this.window['cashtipprCfg'] || {};\n        this.addDefaultConfig(this.config);\n\n        this.webHelpers = new WebHelpers(this.window, this.$, this.config);\n        this.tooltips = new Tooltips(this, this.webHelpers);\n        this.adminControls = new AdminControls(this);\n        this.badger = new BadgerWallet(this, this.webHelpers, true);\n        this.qr = new QrCode(this, this.webHelpers);\n        this.adBlockDetect = new AdBlockDetect(this, this.webHelpers);\n        this.blurryImage = new BlurryImage(this, this.webHelpers);\n        this.shout = new Shout(this, this.webHelpers);\n        this.woocommerce = new Woocommerce(this, this.webHelpers);\n        this.slpPress = new SlpPress(this);\n        this.$(this.window.document).ready(($) => {\n            this.adminConfig = this.window['cashtipprAdminCfg'] || {}; // JS bundle is included early on admin page for AdminSettings\n            if (this.window['cashtipprAdminCfg']) {\n                this.addDefaultConfig(this.adminConfig);\n                this.webHelpers.setConfig(this.adminConfig);\n            }\n            this.adminControls.init();\n            this.webHelpers.checkCookieConsent();\n        });\n    }\n\n    public static toSatoshis(bch: number) {\n        return Math.floor(bch * 100000000);\n    }\n\n    public getConfig() {\n        return this.config;\n    }\n\n    public getAdminConfig() {\n        return this.adminConfig;\n    }\n\n    public getTooltips() {\n        return this.tooltips;\n    }\n\n    public getWebHelpers() {\n        return this.webHelpers;\n    }\n\n    public getBadgerWallet() {\n        return this.badger;\n    }\n\n    public getPluginPaymentID(paymentControlsWrapper: JQuery) {\n        return paymentControlsWrapper.attr(\"id\").replace(/^ct-btn-wrap-/, \"\");\n    }\n\n    public addCopyInputListeners() {\n        this.$(\".ct-copy-field\").click((event) => {\n            event.preventDefault();\n            const inputEl = this.$(event.target).parent().find(\"input[type='text']\");\n            //let text = inputEl.val();\n            inputEl.select();\n            try {\n                this.window.document.execCommand(\"copy\");\n            }\n            catch (err) { // try-catch shouldn't be needed except for some really old browsers\n            }\n            inputEl.select(); // ensure it's selected again for iOS devices to copy it manually. not working, remove?\n        });\n        this.$(\"#ct-qrcode-form input[type='text']\").click((event) => {\n            this.$(event.target).select();\n        });\n        if (this.webHelpers.isAppleIOS() === true) // copy to clipboard button doesn't work there\n            this.$(\"#ct-qrcode-form .ct-copy-field\").addClass(\"hidden\");\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected addDefaultConfig(config: WebHelpersConfig) {\n        config.consentCookieName = CashTippr.CONSENT_COOKIE_NAME;\n        config.confirmCookiesMsg = CashTippr.CONFIRM_COOKIES_MSG;\n        config.confirmCookiesBtn = CashTippr.CONFIRM_COOKIES_BTN;\n    }\n}\n","import {CashTippr} from \"./src/CashTippr\";\n\nlet cashtippr = new CashTippr(window, jQuery);\n(window as any).cashtippr = cashtippr;","import {CashTippr} from \"../CashTippr\";\nimport {AbstractModule} from \"../AbstractModule\";\nimport {WebHelpers} from \"../WebHelpers\";\n\nexport class Tooltips extends AbstractModule {\n\n    constructor(cashtippr: CashTippr, webHelpers: WebHelpers) {\n        super(cashtippr, webHelpers);\n    }\n\n    /**\n     * Initializes status bar hover entries.\n     */\n    public initToolTips() {\n        const window = this.cashtippr.window;\n        const jQuery = this.cashtippr.$;\n        const that = this;\n        const tsfL10n = { // TODO localization\n            states: {\n                debug: false\n            }\n        }\n\n        let touchBuffer = 0,\n            inTouchBuffer = false;\n\n        const setTouchBuffer = function() {\n            inTouchBuffer = true;\n            clearTimeout( touchBuffer );\n            touchBuffer = setTimeout( function() {\n                inTouchBuffer = false;\n            }, 250 );\n        }\n\n        const setEvents = function( target, unset = false ) {\n\n            unset = unset || false;\n\n            let touchEvents = 'pointerdown.tsfTT touchstart.tsfTT click.tsfTT',\n                $target = jQuery( target );\n\n            if ( unset ) {\n                $target.off( 'mousemove mouseleave mouseout ct-tooltip-update' );\n                jQuery( document.body ).off( touchEvents );\n            } else {\n                $target.on( {\n                    'mousemove'  : mouseMove,\n                    'mouseleave' : mouseLeave,\n                    'mouseout'   : mouseLeave,\n                } );\n                jQuery( document.body ).off( touchEvents ).on( touchEvents, touchRemove );\n            }\n\n            $target.on( 'ct-tooltip-update', updateDesc );\n        }\n        const unsetEvents = function( target ) {\n            setEvents( target, true );\n        }\n        const updateDesc = function( event ) {\n            if ( event.target.classList.contains( 'ct-tooltip-item' ) ) {\n                let tooltipText = event.target.querySelector( '.ct-tooltip-text' );\n                if ( tooltipText instanceof Element )\n                    tooltipText.innerHTML = event.target.dataset.desc;\n            }\n        }\n        const mouseEnter = function( event ) {\n            let $hoverItem = jQuery( event.target ),\n                desc = event.target.dataset.desc;\n\n            if ( desc && 0 === $hoverItem.find( 'div' ).length ) {\n                //= Remove any titles attached.\n                event.target.title = \"\";\n\n                let $tooltip = jQuery(\n                    '<div class=\"ct-tooltip\"><span class=\"ct-tooltip-text-wrap\"><span class=\"ct-tooltip-text\">'\n                    + desc +\n                    '</span></span><div class=\"ct-tooltip-arrow\"></div></div>'\n                );\n                $hoverItem.append( $tooltip );\n\n                let $boundary = $hoverItem.closest( '.ct-tooltip-boundary' );\n                $boundary = $boundary.length && $boundary || jQuery( document.body );\n\n                //= 9 = arrow (8) + shadow (1)\n                let tooltipHeight = $hoverItem.outerHeight() + 9,\n                    tooltipTop = $tooltip.offset().top - tooltipHeight,\n                    boundaryTop = $boundary.offset().top - ( $boundary.prop( 'scrolltop' ) || 0 );\n\n                if ( boundaryTop > tooltipTop ) {\n                    $tooltip.addClass( 'ct-tooltip-down' );\n                    $tooltip.css( 'top', tooltipHeight + 'px' );\n                } else {\n                    $tooltip.css( 'bottom', tooltipHeight + 'px' );\n                }\n\n                let $hoverItemWrap = $hoverItem.closest( '.ct-tooltip-wrap' ),\n                    $textWrap = $tooltip.find( '.ct-tooltip-text-wrap' ),\n                    $innerText = $textWrap.find( '.ct-tooltip-text' ),\n                    hoverItemWrapWidth = $hoverItemWrap.width(),\n                    textWrapWidth = $textWrap.outerWidth( true ),\n                    textWidth = $innerText.outerWidth( true ),\n                    textLeft = $textWrap.offset().left,\n                    textRight = textLeft + textWidth,\n                    boundaryLeft = $boundary.offset().left - ( $boundary.prop( 'scrollLeft' ) || 0 ),\n                    boundaryRight = boundaryLeft + $boundary.outerWidth();\n\n                //= RTL and LTR are normalized to abide to left.\n                let direction = 'left';\n\n                if ( textLeft < boundaryLeft ) {\n                    //= Overflown over left boundary (likely window)\n                    //= Add indent relative to boundary. 24px width of arrow / 2 = 12 middle\n                    let horIndent = boundaryLeft - textLeft + 12,\n                        basis = parseInt( $textWrap.css( 'flex-basis' ), 10 );\n\n                    /**\n                     * If the overflow is greater than the tooltip flex basis,\n                     * the tooltip was grown. Shrink it back to basis and use that.\n                     */\n                    if ( horIndent < -basis )\n                        horIndent = -basis;\n\n                    $tooltip.css( direction, horIndent + 'px' );\n                    $tooltip.data( 'overflow', horIndent );\n                    $tooltip.data( 'overflowDir', direction );\n                } else if ( textRight > boundaryRight ) {\n                    //= Overflown over right boundary (likely window)\n                    //= Add indent relative to boundary. Add 12px for visual appeal.\n                    let horIndent = boundaryRight - textRight - hoverItemWrapWidth - 12,\n                        basis = parseInt( $textWrap.css( 'flex-basis' ), 10 );\n\n                    /**\n                     * If the overflow is greater than the tooltip flex basis,\n                     * the tooltip was grown. Shrink it back to basis and use that.\n                     */\n                    if ( horIndent < -basis )\n                        horIndent = -basis;\n\n                    $tooltip.css( direction, horIndent + 'px' );\n                    $tooltip.data( 'overflow', horIndent );\n                    $tooltip.data( 'overflowDir', direction );\n                } else if ( hoverItemWrapWidth < 42 ) {\n                    //= Small tooltip container. Add indent to make it visually appealing.\n                    let indent = -15;\n                    $tooltip.css( direction, indent + 'px' );\n                    $tooltip.data( 'overflow', indent );\n                    $tooltip.data( 'overflowDir', direction );\n                } else if ( hoverItemWrapWidth > textWrapWidth ) {\n                    //= Wrap is bigger than tooltip. Adjust accordingly.\n                    let pagex = event.originalEvent && event.originalEvent.pageX || event.pageX, // iOS touch support,\n                        hoverItemLeft = $hoverItemWrap.offset().left,\n                        center = pagex - hoverItemLeft,\n                        left = center - textWrapWidth / 2,\n                        right = left + textWrapWidth;\n\n                    if ( left < 0 ) {\n                        //= Don't overflow left.\n                        left = 0;\n                    } else if ( right > hoverItemWrapWidth ) {\n                        //= Don't overflow right.\n                        //* Use textWidth instead of textWrapWidth as it gets squashed in flex.\n                        left = hoverItemWrapWidth - textWidth;\n                    }\n\n                    $tooltip.css( direction, left + 'px' );\n                    $tooltip.data( 'adjust', left );\n                    $tooltip.data( 'adjustDir', direction );\n                }\n            }\n        }\n        const mouseMove = function( event ) {\n            let $target = jQuery( event.target ),\n                $tooltip = $target.find( '.ct-tooltip' ),\n                $arrow = $tooltip.find( '.ct-tooltip-arrow' ),\n                overflow = $tooltip.data( 'overflow' ),\n                overflowDir = $tooltip.data( 'overflowDir' );\n\n            overflow = parseInt( overflow, 10 );\n            overflow = isNaN( overflow ) ? 0 : - Math.round( overflow );\n\n            if ( overflow ) {\n                //= Static arrow based on static overflow.\n                $arrow.css( overflowDir, overflow + \"px\" );\n            } else {\n                let pagex = event.originalEvent && event.originalEvent.pageX || event.pageX, // iOS touch support\n                    arrowBoundary = 7,\n                    arrowWidth = 16,\n                    $hoverItemWrap = $target.closest( '.ct-tooltip-wrap' ),\n                    mousex = pagex - $hoverItemWrap.offset().left - arrowWidth / 2,\n                    originalMousex = mousex,\n                    $textWrap = $tooltip.find( '.ct-tooltip-text-wrap' ),\n                    textWrapWidth = $textWrap.outerWidth( true ),\n                    adjust = $tooltip.data( 'adjust' ),\n                    adjustDir = $tooltip.data( 'adjustDir' ),\n                    boundaryRight = textWrapWidth - arrowWidth - arrowBoundary;\n\n                //= mousex is skewed, adjust.\n                adjust = parseInt( adjust, 10 );\n                adjust = isNaN( adjust ) ? 0 : Math.round( adjust );\n                if ( adjust ) {\n                    adjust = 'left' === adjustDir ? -adjust : adjust;\n                    mousex = mousex + adjust;\n\n                    //= Use textWidth for right boundary if adjustment exceeds.\n                    if ( boundaryRight - adjust > $hoverItemWrap.outerWidth( true ) ) {\n                        let $innerText = $textWrap.find( '.ct-tooltip-text' ),\n                            textWidth = $innerText.outerWidth( true );\n                        boundaryRight = textWidth - arrowWidth - arrowBoundary;\n                    }\n                }\n\n                if ( mousex <= arrowBoundary ) {\n                    //* Overflown left.\n                    $arrow.css( 'left', arrowBoundary + \"px\" );\n                } else if ( mousex >= boundaryRight ) {\n                    //* Overflown right.\n                    $arrow.css( 'left', boundaryRight + \"px\" );\n                } else {\n                    //= Somewhere in the middle.\n                    $arrow.css( 'left', mousex + \"px\" );\n                }\n            }\n        }\n        const mouseLeave = function( event ) {\n\n            //* @see touchMove\n            if ( inTouchBuffer )\n                return;\n\n            jQuery( event.target ).find( '.ct-tooltip' ).remove();\n            unsetEvents( event.target );\n        }\n        /**\n         * ^^^\n         * These two methods conflict eachother in EdgeHTML.\n         * Thusly, touch buffer.\n         * vvv\n         */\n        const touchRemove = function( event ) {\n\n            //* @see mouseLeave\n            setTouchBuffer();\n\n            let itemSelector = '.ct-tooltip-item',\n                balloonSelector = '.ct-tooltip';\n\n            let $target = jQuery( event.target ),\n                $keepBalloon;\n\n            if ( $target.hasClass( 'ct-tooltip-item' ) ) {\n                $keepBalloon = $target.find( balloonSelector );\n            }\n            if ( ! $keepBalloon ) {\n                let $children = $target.children( itemSelector );\n                if ( $children.length ) {\n                    $keepBalloon = $children.find( balloonSelector );\n                }\n            }\n\n            if ( $keepBalloon && $keepBalloon.length ) {\n                //= Remove all but this.\n                jQuery( balloonSelector ).not( $keepBalloon ).remove();\n            } else {\n                //= Remove all.\n                jQuery( balloonSelector ).remove();\n            }\n        }\n\n        /**\n         * Loads tooltips within wrapper.\n         * @function\n         */\n        const loadToolTip = function( event ) {\n\n            if ( inTouchBuffer )\n                return;\n\n            let isTouch = false;\n\n            switch ( event.type ) {\n                case 'mouseenter' :\n                    //= Most likely, thus placed first.\n                    break;\n\n                case 'pointerdown' :\n                case 'touchstart' :\n                    isTouch = true;\n                    break;\n\n                default :\n                    break;\n            }\n\n            if ( event.target.classList.contains( 'ct-tooltip-item' ) ) {\n                //= Removes previous items and sets buffer.\n                isTouch && touchRemove( event );\n\n                mouseEnter( event );\n                //= Initiate placement directly for Windows Touch or when overflown.\n                mouseMove( event );\n\n                setEvents( event.target );\n            } else {\n                //= Delegate or bubble, and go back to this method with the correct item.\n                let item = event.target.querySelector( '.ct-tooltip-item:hover' ),\n                    _event = new jQuery.Event( event.type );\n\n                _event.pageX = event.originalEvent && event.originalEvent.pageX || event.pageX;\n\n                if ( item ) {\n                    if ( tsfL10n.states.debug ) console.log( 'Tooltip event warning: delegation' );\n                    jQuery( item ).trigger( _event );\n                } else {\n                    if ( tsfL10n.states.debug ) console.log( 'Tooltip event warning: bubbling' );\n                    jQuery( event.target ).closest( '.ct-tooltip-wrap' ).find( '.ct-tooltip-item:hover' ).trigger( _event );\n                }\n            }\n\n            //* Stop further propagation.\n            event.stopPropagation();\n        }\n\n        /**\n         * Initializes tooltips.\n         * @function\n         */\n        const initTooltips = function() {\n            let $wrap = jQuery( '.ct-tooltip-wrap' );\n\n            $wrap.off( 'mouseenter pointerdown touchstart' );\n            $wrap.on( 'mouseenter pointerdown touchstart', '.ct-tooltip-item', loadToolTip );\n        }\n        initTooltips();\n        jQuery( window ).on( 'ct-reset-tooltips', initTooltips );\n\n        (function() {\n            let e = jQuery( '#wpcontent' );\n            that.addTooltipBoundary( e );\n        })();\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    /**\n     * Adds tooltip boundaries.\n     */\n    protected addTooltipBoundary( e ) {\n        jQuery( e ).addClass( 'ct-tooltip-boundary' );\n    }\n\n    /**\n     * Triggers tooltip reset.\n     */\n    protected _triggerTooltipReset() { // not used yet\n        jQuery( window ).trigger( 'ct-reset-tooltips' );\n    }\n\n    /**\n     * Triggers active tooltip update.\n     */\n    protected _triggerTooltipUpdate(item) { // not used yet\n        jQuery( item ).trigger( 'ct-tooltip-update' );\n    }\n}\n","\nexport interface WebHelpersConfig {\n    cookieLifeDays: number;\n    cookiePath: string;\n    siteUrl: string;\n\n    // DOM ids of elements of cookie consent message\n    consentCookieName: string;\n    confirmCookiesMsg: string;\n    confirmCookiesBtn: string;\n}\n\nexport class WebHelpers {\n    public readonly window: Window;\n    public readonly $: JQueryStatic;\n\n    protected config: WebHelpersConfig;\n    protected cssSelectors: string[] = [];\n\n    constructor(window: Window, $: JQueryStatic, config: WebHelpersConfig) {\n        this.window = window;\n        this.$ = $;\n        this.config = config;\n    }\n\n    public setConfig(config: WebHelpersConfig) {\n        this.config = config;\n    }\n\n    public getBrowserLang() {\n        return this.window.navigator.language.substr(0, 2).toLowerCase();\n    }\n\n    public getCookie(c_name: string) {\n        let i, x, y;\n        let ARRcookies = this.window.document.cookie.split(\";\");\n        for (i = 0; i < ARRcookies.length; i++)\n        {\n            x = ARRcookies[i].substr(0, ARRcookies[i].indexOf(\"=\"));\n            y = ARRcookies[i].substr(ARRcookies[i].indexOf(\"=\") + 1);\n            x = x.replace(/^\\s+|\\s+$/g,\"\");\n            if (x == c_name)\n                return decodeURI(y);\n        }\n        return null;\n    }\n\n    public setCookie(name: string, value: any, expireDays: number) {\n        let date = new Date();\n        date = new Date(date.getTime()+1000*60*60*24* (expireDays ? expireDays : this.config.cookieLifeDays));\n        //document.cookie = name + \"=\" + value + \"; expires=\" + date.toGMTString() + \"; path=\" + pageData.cookiePath + \"; domain=.\" + location.host;\n        this.window.document.cookie = name + \"=\" + value + \"; expires=\" + date.toUTCString() + \"; path=\" + this.config.cookiePath;\n    }\n\n    public removeCookie(name: string) {\n        //document.cookie = name + \"=; expires=Thu, 02 Jan 1970 00:00:00 UTC; path=\" + pageData.cookiePath + \"; domain=.\" + location.host;\n        this.window.document.cookie = name + \"=; expires=Thu, 02 Jan 1970 00:00:00 UTC; path=\" + this.config.cookiePath;\n    }\n\n    public checkCookieConsent() {\n        this.$(this.config.confirmCookiesBtn).click(() => {\n            this.confirmCookies();\n        });\n        if (this.getCookie(this.config.consentCookieName) !== null)\n            this.$(this.config.confirmCookiesMsg).remove(); // we recently showed the cookie confirm message. some pages might still be in browser cache\n    }\n\n    public fromBase64(data: string) {\n        if (typeof this.window.atob !== \"function\") {\n            this.window.console.error(\"Base64 decoding is not supported in your browser\");\n            return \"\";\n        }\n        return this.window.atob(data);\n    }\n\n    public toBase64(data: string) {\n        if (typeof this.window.btoa !== \"function\") {\n            this.window.console.error(\"Base64 encoding is not supported in your browser\");\n            return \"\";\n        }\n        return this.window.btoa(data);\n    }\n\n    /**\n     * Populate a html template\n     * @param text {String}: The html template (or just normal text with variables)\n     * @param variables {Object}: the key-value pairs with variables names and their content to be set in text\n     * @param safeHtml {boolean, default false}: don't escape html characters if set to true\n     * @returns {String} the translated html\n     */\n    public translate(text: string, variables: any, safeHtml: boolean = false) {\n        if (typeof text !== \"string\") {\n            try {\n                // @ts-ignore\n                text = text.toString();\n            }\n            catch (e) {\n                this.log(\"Text to translate is not a string\");\n                return text;\n            }\n        }\n        let start = 0, end = 0;\n        while ((start = text.indexOf(\"{\", start)) !== -1)\n        {\n            if (start > 0 && text.charAt(start-1) === \"\\\\\") { // escaped javascript code beginning\n                start++;\n                continue;\n            }\n            end = text.indexOf(\"}\", start);\n            if (end === -1) {\n                this.log(\"Can not find end position while translating HTML\");\n                break;\n            }\n            let placeHolder = text.substring(start+1, end);\n            let translation = null;\n            if (placeHolder.substring(0, 3) === \"tr:\") {\n                let key = placeHolder.substring(3);\n                //translation = this.tr(key.toUpperCase());\n                translation = this.tr(key);\n            }\n            else if (typeof variables === \"object\") {\n                let textPiece = variables[placeHolder];\n                if (typeof textPiece !== \"undefined\") {\n                    if (typeof safeHtml === \"boolean\" && safeHtml)\n                        translation = textPiece;\n                    else\n                        translation = this.escapeOutput(textPiece);\n                }\n            }\n            if (translation !== null) {\n                let reg = new RegExp(\"\\\\{\" + placeHolder + \"\\\\}\", \"g\");\n                text = text.replace(reg, translation);\n            }\n            else if (placeHolder.match(\"^[A-Za-z0-9_]+$\") !== null) {\n                this.log(\"No translation found for place holder: \" + placeHolder);\n                let reg = new RegExp(\"\\\\{\" + placeHolder + \"\\\\}\", \"g\");\n                text = text.replace(reg, \"MISSING: \" + this.escapeOutput(placeHolder));\n            }\n            else\n                start += placeHolder.length;\n        }\n        text = text.replace(/\\\\\\\\\\\\{/, \"{\");\n        return text;\n    }\n\n    public escapeOutput(text: string, convertNewlines: boolean = true) {\n        if (typeof text !== \"string\")\n            return text;\n        text = text.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#039;\");\n        if (typeof convertNewlines === \"undefined\" || convertNewlines === true)\n            text = text.replace(/\\r?\\n/g, \"<br>\");\n        return text;\n    }\n\n    public escapeRegex(str: string) {\n        return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n    }\n\n    public tr(key: string) {\n        //if (typeof language[key] === \"undefined\")\n        //return \"MISSING: \" + key;\n        //return language[key];\n        //return i18next.t(key) // will just print the key if it doesn't exist and debug is disabled\n        return key; // we don't have client-side translation support on this WP plugin yet. just return the key // TODO do we need this if we make our plugin use more ajax?\n    }\n\n    public log(args) {\n        if (//typeof pageData.debugLog !== \"boolean\" || pageData.debugLog === false || // TODO add in CashTipprConfig\n            typeof this.window.console !== \"object\" || typeof this.window.console.log !== \"function\")\n            return;\n        this.window.console.log(arguments);\n    }\n\n    public isAppleIOS() {\n        // https://stackoverflow.com/questions/9038625/detect-if-device-is-ios\n        return /iPad|iPhone|iPod/.test(this.window.navigator.userAgent) && !(this.window as any).MSStream;\n    }\n\n    public getAllCssSelectors(cached = true): string[] {\n        if (cached === true && this.cssSelectors.length !== 0)\n            return this.cssSelectors;\n\n        this.cssSelectors = [];\n        try {\n            const originRegex = new RegExp(\"^\" + this.escapeRegex(this.window.document.location.origin), \"i\");\n            for (let i = 0; i < this.window.document.styleSheets.length; i++)\n            {\n                const sheet: any = this.window.document.styleSheets[i];\n                if (sheet.href && originRegex.test(sheet.href) === false)\n                    continue; // can't access it\n                if (sheet.rules) {\n                    for (let u = 0; u < sheet.rules.length; u++)\n                    {\n                        if (sheet.rules[u].selectorText)\n                            this.cssSelectors.push(sheet.rules[u].selectorText);\n                    }\n                }\n                if (sheet.imports) {\n                    for (let x = 0; x < sheet.imports.length; x++)\n                    {\n                        for (let u = 0; u < sheet.imports[x].rules.length; u++)\n                        {\n                            if (sheet.imports[x].rules[u].selectorText)\n                                this.cssSelectors.push(sheet.imports[x].rules[u].selectorText);\n                        }\n                    }\n                }\n            }\n        }\n        catch (err) {\n            this.window.console.error(\"Error getting CSS selectors\", err);\n        }\n        return this.cssSelectors;\n    }\n\n    public isExistingCssSelector(selector: string): boolean {\n        const selectors = this.getAllCssSelectors();\n        for (let i = 0; i < selectors.length; i++)\n        {\n            if (selectors[i] === selector) // css props case insensitive, class names in HTML case sensitive\n                return true;\n        }\n        return false;\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected confirmCookies() {\n        /* // no data stored in session\n        this.getApi('/json/cookies', function(data) {\n            if (data.error)\n                //Hlp.showMsg(i18next.t('errorSending'), 'danger');\n                console.error(\"Error sending data\");\n            else {\n            }\n        })\n        */\n        this.$(this.config.confirmCookiesMsg).remove();\n        this.setCookie(this.config.consentCookieName, \"1\", this.config.cookieLifeDays);\n    }\n\n    public getApi(path: string, data?: any, callback?: (data: any, textStatus: string, jqXHR: JQueryXHR) => any, dataType?: string) {\n        if (typeof data === \"function\") {\n            callback = data;\n            data = null;\n        }\n        else if (data === undefined)\n            data = null;\n        let url = path;\n        if (url.toLowerCase().indexOf(\"http\") !== 0)\n            url = this.config.siteUrl + url;\n        return this.$.get(url, data, (data, textStatus, jqXHR) => {\n            callback(data, textStatus, jqXHR);\n        }, dataType);\n    }\n\n    postApi(path: string, data?: any, callback?: (data: any, textStatus: string, jqXHR: JQueryXHR) => any, dataType?: string) {\n        let url = path;\n        if (url.toLowerCase().indexOf(\"http\") !== 0)\n            url = this.config.siteUrl + url;\n        return this.$.post(url, data, (data, textStatus, jqXHR) => {\n            callback(data, textStatus, jqXHR);\n        }, dataType);\n    }\n\n    postApiJson(path: string, data?: any, callback?: (data: any, textStatus: string, jqXHR: JQueryXHR) => any, dataType?: string) {\n        let outData = {\n            data: JSON.stringify(data)\n        };\n        return this.postApi(path, outData, callback, dataType);\n    }\n}\n","import {CashTippr} from \"./CashTippr\";\nimport {AbstractModule} from \"./AbstractModule\";\nimport {WebHelpers} from \"./WebHelpers\";\n\n/**\n * The class for displaying blurry images.\n * We bundle it together with all our JavaScript instead of with the addon because\n * a 2nd JS WebPack project would create unnecessary dependency + bootstrap overhead.\n */\nexport class BlurryImage extends AbstractModule {\n\n    constructor(cashtippr: CashTippr, webHelpers: WebHelpers) {\n        super(cashtippr, webHelpers)\n        // TODO implement events this class (and other addons) can listen to so that we don't have to call functions in here directly\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n}\n","import {AbstractPayment, CashTippr} from \"./CashTippr\";\nimport {WebHelpers} from \"./WebHelpers\";\nimport {AbstractModule} from \"./AbstractModule\";\n\n/**\n * The class for displaying the shout addon.\n * We bundle it together with all our JavaScript instead of with the addon because\n * a 2nd JS WebPack project would create unnecessary dependency + bootstrap overhead.\n */\nexport class Shout extends AbstractModule {\n    protected scheduleUpdateTimerID = 0;\n\n    constructor(cashtippr: CashTippr, webHelpers: WebHelpers) {\n        super(cashtippr, webHelpers);\n        // TODO implement events this class (and other addons) can listen to so that we don't have to call functions in here directly\n        this.cashtippr.$(this.cashtippr.window.document).ready(($) => {\n            if (this.cashtippr.$(\".ct-message\").length !== 0) {\n                this.updateRemainingChars();\n                this.addEventListeners();\n            }\n        });\n\n        // admin area\n        this.cashtippr.$(this.cashtippr.window.document).ready(($) => {\n            this.addConfirmDeleteMessages();\n        })\n    }\n\n    public onPayment(payment: AbstractPayment) {\n        setTimeout(() => { // shouldn't be needed, but BadgerWallet is really fast (running locally). just be sure the WP backend processed our payment\n            this.cashtippr.$(\"#\" + payment.domID).parent().parent().submit();\n        }, 500);\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected updateRemainingChars() {\n        const forms = this.cashtippr.$(\".ct-message\").parent().parent();\n        this.cashtippr.$.each(forms, (index, value) => {\n            const formEl = this.cashtippr.$(value);\n            let text = formEl.find(\".ct-message\").val();\n            let maxChars = parseInt(formEl.find(\".ct-max-chars\").val());\n            const remaining = maxChars - text.length;\n            formEl.find(\".ct-chars-left\").text(remaining);\n            if (remaining < 0) {\n                formEl.find(\".ct-chars-left\").css(\"color\", \"red\");\n                formEl.find(\".ct-shout\").prop(\"disabled\", true);\n                formEl.find(\".ct-button\").fadeOut(\"slow\");\n            }\n            else {\n                formEl.find(\".ct-chars-left\").css(\"color\", \"\");\n                if (text.length === 0) { // don't let the user submit empty messages\n                    formEl.find(\".ct-shout\").prop(\"disabled\", true);\n                    formEl.find(\".ct-button\").fadeOut(\"slow\");\n                }\n                else {\n                    formEl.find(\".ct-shout\").prop(\"disabled\", false);\n                    formEl.find(\".ct-button\").fadeIn(\"slow\");\n                }\n            }\n        });\n    }\n\n    protected addEventListeners() {\n        this.cashtippr.$(\".ct-message\").keyup((event) => {\n            this.scheduleCharsUpdate();\n        });\n        this.cashtippr.$(\".ct-message\").change((event) => {\n            this.scheduleCharsUpdate();\n        });\n        this.cashtippr.$(\".ct-shout-form\").on(\"submit.cashtippr\", (event) => { // fix for badger wallet submitting form on click (before payment)\n            event.preventDefault();\n            this.cashtippr.$(event.target).off(\"submit.cashtippr\");\n        });\n    }\n\n    protected addConfirmDeleteMessages() {\n        this.cashtippr.$(\".ct-delete-shout-link\").on(\"click\", (event) => {\n            const question = this.cashtippr.$(\"#ct-delete-shout-confirm\").text();\n            if (this.cashtippr.window.confirm(question) === true)\n                return;\n            event.preventDefault();\n            return false; // should't be needed anymore in 2018\n        });\n    }\n\n    protected scheduleCharsUpdate() {\n        if (this.scheduleUpdateTimerID !== 0)\n            clearTimeout(this.scheduleUpdateTimerID);\n        this.scheduleUpdateTimerID = setTimeout(() => {\n            this.updateRemainingChars();\n        }, 50);\n    }\n}\n","import {AbstractPayment, CashTippr, CashtipprApiRes} from \"./CashTippr\";\nimport {WebHelpers} from \"./WebHelpers\";\nimport {AbstractModule} from \"./AbstractModule\";\n\n\nexport class QrCode extends AbstractModule {\n\n    constructor(cashtippr: CashTippr, webHelpers: WebHelpers) {\n        super(cashtippr, webHelpers);\n\n        this.cashtippr.$(this.cashtippr.window.document).ready(($) => {\n            this.cashtippr.$(\".ct-qrcode-btn\").click((event) => {\n                this.showQrDialog(event.target);\n            });\n        });\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected showQrDialog(target: Element) {\n        const paymentButtonWrapper = this.cashtippr.$(target).parent().parent().parent().parent();\n        const txid = this.cashtippr.getPluginPaymentID(paymentButtonWrapper);\n        const paymentCtrlWrapper = paymentButtonWrapper.parent();\n        let amount = 0.0;\n        if (paymentCtrlWrapper.find(\"input[name='amount']\").length !== 0)\n            amount = paymentCtrlWrapper.find(\"input[name='amount']\").val(); // custom editable amount by user\n        let params = {\n            txid: txid,\n            am: amount\n        }\n        let dialog = this.webHelpers.translate(this.cashtippr.$(\"#ct-modal-qrcode-dialog-tpl\").html(), {\n            dialog_class: \"dialog-\" + txid\n        });\n        this.cashtippr.$(\"body\").append(dialog); // its position is fixed relative to the viewport\n\n        this.webHelpers.getApi(\"/wp-json/cashtippr/v1/qrcode\", params, (data) => {\n            this.cashtippr.$(\".ct-loading\").remove();\n            if (data.error === true) {\n                this.cashtippr.window.console.error(\"Error starting QR code tip\");\n                this.cashtippr.window.console.error(data.errorMsg);\n                return;\n            }\n            this.cashtippr.$(\".ct-qr-code\").fadeIn(\"slow\").attr(\"src\", data.data[0]);\n        });\n\n        this.cashtippr.$(\".ct-close-dialog\").click((event) => {\n            this.cashtippr.$(\".dialog-\" + txid).remove();\n        });\n        this.cashtippr.addCopyInputListeners();\n    }\n}\n","import {AbstractPayment, CashTippr, CashtipprApiRes} from \"./CashTippr\";\nimport {WebHelpers} from \"./WebHelpers\";\nimport {AbstractModule} from \"./AbstractModule\";\n\nexport interface BadgerWalletPayment extends AbstractPayment {\n    buttonId: string; // unique ID, tx ID in our case\n    txid: string;\n    amount: number;\n    currency: string;\n    buttonData: string; // JSON string \"{}\" or base64 data in our app\n    buttonDataObj: any; // unserialized JS object from buttonData\n}\n\nexport class BadgerWallet extends AbstractModule {\n    protected static readonly INSTALL_URL = \"https://badger.bitcoin.com/\";\n\n    protected globalCallbacks: boolean; // expose callback functions to window object because BadgerButton currently doesn't support functions on objects\n\n    constructor(cashtippr: CashTippr, webHelpers: WebHelpers, globalCallbacks = false) {\n        super(cashtippr, webHelpers);\n        this.globalCallbacks = globalCallbacks;\n\n        if (this.globalCallbacks === true) {\n            setTimeout(() => { // must be done after constructor or else functions are undefined\n                this.cashtippr.window['onBadgerPayment'] = this.onBadgerPayment;\n                this.cashtippr.window['onBadgerClientPayment'] = this.sendPaymentReceived;\n            }, 0);\n        }\n\n        this.cashtippr.$(this.cashtippr.window.document).ready(($) => {\n            this.cashtippr.$(\".ct-input-amount\").keyup((event) => {\n                this.updateButtonAmount(event.target);\n            });\n            this.cashtippr.$(\".ct-input-amount\").change((event) => {\n                this.updateButtonAmount(event.target);\n            });\n            this.addEventListeners();\n        });\n    }\n\n    public isInstalled() {\n        return (this.cashtippr.window as any).web4bch !== undefined;\n    }\n\n    public isLoggedIn() {\n        const wnd: any = this.cashtippr.window;\n        return typeof wnd.web4bch.bch.defaultAccount === \"string\" && wnd.web4bch.bch.defaultAccount !== \"\";\n    }\n\n    public getDefaultAddress(): string {\n        return (this.cashtippr.window as any).web4bch.bch.defaultAccount;\n    }\n\n    public getDefaultSlpAddress(): string {\n        return (this.cashtippr.window as any).web4bch.bch.defaultSlpAccount;\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected onBadgerPayment(payment: BadgerWalletPayment) {\n        if (typeof payment.buttonData === \"string\" && payment.buttonData.length !== 0 && payment.buttonData[0] !== \"{\")\n            payment.buttonDataObj = JSON.parse(this.cashtippr.getWebHelpers().fromBase64(payment.buttonData)) || {}; // this.webHelpers is undefined\n        if (payment.domID === undefined)\n            payment.domID = \"ct-btn-wrap-\" + payment.buttonId;\n        //console.log(\"Badger Payment\", payment);\n\n        // TODO make an ajax call to WP to check if the payment has actually been received (will an extension support some webhook callback? likely not)\n        // then depending on if the content is hidden with CSS: modify style or reload page (server can tell this, or we add a variable)\n        // simply always remove the style\n        const config = this.cashtippr.getConfig();\n        if (config.show_search_engines === true || config.ajaxConfirm === true) {\n            //this.cashtippr.$(\".ct-hidden-text\").css(\"cssText\", \"display: inherit!important;\");\n            // especially with editable + hidden button on same page\n\n            if (!payment.buttonDataObj || payment.buttonDataObj.days !== 0) { // show everything for full passes\n                this.cashtippr.$(\".ct-hidden-text\").fadeIn(\"slow\");\n                this.cashtippr.$(\".ct-more, .ct-button-text, .ct-image-blurry\").fadeOut(\"slow\");\n            }\n            else { // only show the contents hidden in this button\n                this.cashtippr.$(\"#ct-hidden-\" + payment.buttonId).fadeIn(\"slow\");\n                this.cashtippr.$(\"#ct-button-text-\" + payment.buttonId + \", #ct-image-blurry-\" + payment.buttonId).fadeOut(\"slow\");\n                if (payment.buttonDataObj.postHide === true) // auto hide of the full post. there can only be 1 such element\n                    this.cashtippr.$(\".ct-more\").fadeOut(\"slow\");\n            }\n            //this.sendPaymentReceived(payment);\n            this.cashtippr.window['onBadgerClientPayment'].call(this.cashtippr.badger, payment, (res: CashtipprApiRes) => {\n                if (payment.buttonDataObj && payment.buttonDataObj.shout === true)\n                    this.cashtippr.shout.onPayment(payment);\n                if (payment.buttonDataObj && payment.buttonDataObj.woocommerce === true)\n                    this.cashtippr.woocommerce.onPayment(payment);\n                this.cashtippr.adBlockDetect.onPayment(payment);\n            });\n            // TODO increment tips received and donation goal progress with JS\n            if (typeof this.cashtippr.window['onCashtipprPayment'] === \"function\")\n                this.cashtippr.window['onCashtipprPayment'].call(this.cashtippr.window, {badger: payment});\n            return;\n        }\n\n        this.cashtippr.window['onBadgerClientPayment'].call(this.cashtippr.badger, payment, (res: CashtipprApiRes) => {\n            if (payment.buttonDataObj && payment.buttonDataObj.shout === true) {\n                this.cashtippr.shout.onPayment(payment);\n                return; // this will already reload the page\n            }\n            // TODO add random query param to bypass caching? look at different WP caching plugins first\n            // some might ignore query strings\n            // better way would be to implement WP hooks to bypass cache for paid users (if provided by cache plugins)\n            // to make it work with full-page caching we have to fetch params such as TXID via ajax either way\n            this.cashtippr.window.location.reload(true);\n        });\n    }\n\n    protected addEventListeners() {\n        this.cashtippr.$(\".ct-badger-button\").click((event) => {\n            if (this.isInstalled() === false)\n                this.cashtippr.window.open(BadgerWallet.INSTALL_URL, \"\", \"\");\n            else if (this.isLoggedIn() === false) {\n                event.preventDefault();\n                this.cashtippr.window.alert(this.cashtippr.getConfig().badgerLocked);\n            }\n            else\n                this.sendPayment(event.target);\n        });\n    }\n\n    protected sendPayment(button: Element) {\n        const wnd: any = this.cashtippr.window;\n        let web4bch = wnd.web4bch;\n        web4bch = new wnd.Web4Bch(web4bch.currentProvider);\n\n        const btn = this.cashtippr.$(button);\n        let txParams: any = {\n            to: btn.attr(\"data-to\"),\n            from: web4bch.bch.defaultAccount,\n            value: btn.attr(\"data-satoshis\")\n        }\n\n        web4bch.bch.sendTransaction(txParams, (err, res) => {\n            if (err) {\n                this.cashtippr.window.console.log(\"Error sending payment\", err);\n                return;\n            }\n            // call the corresponding inline-javascript for this button\n            let callback = btn.attr(\"data-success-callback\");\n            if (callback && typeof this.cashtippr.window[callback] === \"function\")\n                this.cashtippr.window[callback](res); // res is just the txid as string\n        });\n    }\n\n    protected sendPaymentReceived(payment: BadgerWalletPayment, callback?: (res: CashtipprApiRes) => void) {\n        let params = {\n            txid: payment.buttonId,\n            am: payment.amount,\n            keep: this.cashtippr.getConfig().keepTransaction === true\n        }\n        this.webHelpers.getApi(\"/wp-json/cashtippr/v1/mb-client\", params, (data) => {\n            callback && callback(data);\n        });\n    }\n\n    protected updateButtonAmount(target: Element) {\n        const btnContainer = this.cashtippr.$(target).parent().parent();\n        const btn = btnContainer.find(\".badger-button\");\n        if (!btn) {\n            this.cashtippr.window.console.error(\"Unable to find Badger button\", btnContainer);\n            return;\n        }\n        const amountNewUserCurrency = parseFloat(this.cashtippr.$(target).val());\n        if (amountNewUserCurrency === 0.0 || amountNewUserCurrency === Number.NaN)\n            return;\n        const currency = this.cashtippr.getConfig().display_currency;\n        const amountSats = CashTippr.toSatoshis(amountNewUserCurrency / this.cashtippr.getConfig().rate[currency]);\n        btn.attr(\"data-satoshis\", amountSats);\n        btn.find(\".ct-btn-display-amount\").text(amountNewUserCurrency);\n    }\n}\n","import {AbstractModule} from \"./AbstractModule\";\nimport {CashTippr} from \"./CashTippr\";\nimport {FingerPrint} from \"./FingerPrint\";\nimport {SlpAddress} from \"./structs/SlpAddress\";\n\n\nexport interface SlpPressConfig {\n    userID: number;\n    //amount: number;\n    amountLow: number;\n    timeSec: number;\n    id: string;\n    ticker: string;\n    name: string;\n    icon: string;\n    website: string;\n\n    // localizations\n    tr: {\n        unlockBadger: string;\n        badgerReceived: string;\n        walletReceived: string;\n        enterWallet: string;\n        moreInfo: string;\n        invalidAddress: string;\n        configureToken: string;\n        invalidPassphrase: string;\n        importOk: string;\n        confirmDeleteWallet: string;\n        laavePage: string;\n    }\n\n    html: {\n        tokenMsg: string;\n        askWallet: string;\n    }\n\n    admin?: { // only present for admins\n        token: string;\n        address: string;\n        addressBch: string;\n        mnemonic: string;\n    }\n}\n\nexport class SlpPress extends AbstractModule {\n    protected fingerPrint: FingerPrint;\n\n    constructor(cashtippr: CashTippr) {\n        super(cashtippr);\n        if (this.cashtippr.getConfig().distributeTokens === undefined || this.cashtippr.$(\"body\").hasClass(\"wp-admin\") === true)\n            return;\n        this.fingerPrint = new FingerPrint(this.cashtippr);\n        this.cashtippr.$(this.cashtippr.window.document).ready(($) => {\n            setTimeout(this.checkTokens.bind(this), this.cashtippr.getConfig().distributeTokens.timeSec*1000);\n        });\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected startSendingTokens(amount: number, slpAddress: string) {\n        const conf = this.cashtippr.getConfig().distributeTokens;\n        const badgerWallet = this.cashtippr.getBadgerWallet();\n        if (badgerWallet.isInstalled() === true) { // if badger wallet is installed we send tokens to it\n            if (badgerWallet.isLoggedIn() === false)\n                this.showTokenInfo(this.cashtippr.getWebHelpers().translate(conf.tr.unlockBadger, {\n                    amount: amount,\n                    ticker: conf.ticker\n                }), true, false);\n            else {\n                let receivedHtml = this.cashtippr.getWebHelpers().translate(conf.tr.badgerReceived, {\n                    amount: amount,\n                    ticker: conf.ticker\n                });\n                this.showTokenInfo(receivedHtml + '<br>' + this.getTokenInfoLink(), false, true);\n            }\n            return;\n        }\n\n        // otherwise send it to the user's external wallet (we stored in server session)\n        if (!slpAddress) {\n            // we ask for the user's SLP address\n            let askHtml = this.cashtippr.getWebHelpers().translate(conf.tr.enterWallet, {\n                amount: amount,\n                ticker: conf.ticker,\n            });\n            this.askUserWallet(askHtml + '<br>' + this.getTokenInfoLink());\n        }\n        else {\n            let receivedHtml = this.cashtippr.getWebHelpers().translate(conf.tr.walletReceived, {\n                amount: amount,\n                ticker: conf.ticker,\n                address: slpAddress\n            });\n            this.showTokenInfo(receivedHtml + '<br>' + this.getTokenInfoLink(), false, true);\n        }\n    }\n\n    protected showTokenInfo(message: string, showReload = true, showClose = false) {\n        let html = this.cashtippr.getConfig().distributeTokens.html.tokenMsg;\n        const barHeight = this.getWpAdminbarHeight();\n        html = this.webHelpers.translate(html, {\n            message: message,\n            style: barHeight !== 0.0 ? \"top: \" + barHeight + \"px;\" : \"\",\n        }, true);\n        this.cashtippr.$(\"body\").append(html);\n\n        // Close button\n        if (showClose === false)\n            this.cashtippr.$(\".ct-close-message\").css(\"display\", \"none\");\n        this.cashtippr.$(\".ct-close-message\").off(\"click\").on(\"click\", (event) => {\n            this.cashtippr.$(\"#ct-tokenMsg\").remove();\n        });\n\n        // Reload Button\n        if (showReload === false) {\n            this.cashtippr.$(\".ct-reload-page\").css(\"display\", \"none\");\n            return;\n        }\n        this.cashtippr.$(\".ct-reload-page\").off(\"click\").on(\"click\", (event) => {\n            this.cashtippr.window.document.location.reload();\n        });\n    }\n\n    protected askUserWallet(message: string) {\n        let html = this.cashtippr.getConfig().distributeTokens.html.askWallet;\n        const barHeight = this.getWpAdminbarHeight();\n        html = this.webHelpers.translate(html, {\n            message: message,\n            style: barHeight !== 0.0 ? \"top: \" + barHeight + \"px;\" : \"\",\n        }, true);\n        this.cashtippr.$(\"body\").append(html);\n\n        this.cashtippr.$(\"#ct-input-slp-wallet-form\").off(\"submit\").on(\"submit\", (event) => {\n            event.preventDefault();\n            let params = {\n                slpWallet: this.cashtippr.$(\"#ct-slp-wallet\").val()\n            }\n            if (SlpAddress.isValidSlpAddress(params.slpWallet) === false) {\n                this.cashtippr.window.alert(this.cashtippr.getConfig().distributeTokens.tr.invalidAddress);\n                return;\n            }\n            this.webHelpers.postApi(\"/wp-json/cashtippr-slp-press/v1/add-wallet\", params, (data) => {\n                if (data.error === true) {\n                    this.cashtippr.window.console.error(\"CashTippr: Error adding wallet:\", data);\n                    return;\n                }\n                this.cashtippr.$(\"#ct-tokenMsg\").remove();\n                this.checkTokens(); // call it again\n            });\n        });\n    }\n\n    protected getWpAdminbarHeight(): number {\n        return this.cashtippr.$(\"#wpadminbar\").height() ?? 0.0;\n        //return this.cashtippr.$(\"#wpadminbar\").length !== 0 ? this.cashtippr.$(\"#wpadminbar\").height() + 4 : 0.0;\n    }\n\n    protected getTokenInfoLink(): string {\n        const conf = this.cashtippr.getConfig().distributeTokens;\n        let linkHtml = '<div class=\"ct-token-info\"><a target=\"_blank\" href=\"url\">';\n        if (conf.icon)\n            linkHtml += '<img src=\"{iconSrc}\" alt=\"{ticker}\" width=\"32\" height=\"32\"> ';\n        linkHtml += '{text}</a></div>';\n        return this.cashtippr.getWebHelpers().translate(linkHtml, {\n            url: conf.website,\n            text: conf.tr.moreInfo,\n            iconSrc: conf.icon,\n            ticker: conf.ticker\n        });\n    }\n\n    protected checkTokens() {\n        let params: any = {\n            userID: this.cashtippr.getConfig().distributeTokens.userID,\n            fingerprint: this.fingerPrint.getCanvasFingerPrint()\n        }\n        const badgerWallet = this.cashtippr.getBadgerWallet();\n        if (badgerWallet.isInstalled() === true) {\n            const badgerSlpAddress = badgerWallet.getDefaultSlpAddress();\n            if (badgerSlpAddress)\n                params.badgerSlpAddress = badgerSlpAddress;\n        }\n        this.webHelpers.postApi(\"/wp-json/cashtippr-slp-press/v1/check-tokens\", params, (data) => {\n            if (data.error === true) {\n                this.cashtippr.window.console.error(\"CashTippr: Error checking for tokens:\", data);\n                return;\n            }\n            const amount = data.data[0].amount;\n            if (amount > 0.0)\n                this.startSendingTokens(amount, data.data[0].slpAddress);\n        });\n    }\n}\n","import {AbstractModule} from \"./AbstractModule\";\nimport {CashTippr} from \"./CashTippr\";\n\nexport class FingerPrint extends AbstractModule {\n    constructor(cashtippr: CashTippr) {\n        super(cashtippr);\n    }\n\n    public getCanvasFingerPrint(): string {\n        this.cashtippr.$(\"body\").append('<canvas id=\"ct-canvas\" width=\"60\" height=\"20\"></canvas>');\n        let testCanvas = this.cashtippr.window.document.getElementById('ct-canvas') as HTMLCanvasElement;\n        let ctx = testCanvas.getContext('2d');\n        // Text with lowercase/uppercase/punctuation symbols\n        let txt = \"CashTippr.,com <canvas> 1.0\";\n        ctx.textBaseline = \"top\";\n        // The most common type\n        ctx.font = \"14px 'Arial'\";\n        ctx.textBaseline = \"alphabetic\";\n        ctx.fillStyle = \"#f60\";\n        ctx.fillRect(125,1,62,20);\n        // Some tricks for color mixing to increase the difference in rendering\n        ctx.fillStyle = \"#069\";\n        ctx.fillText(txt, 2, 15);\n        ctx.fillStyle = \"rgba(102, 204, 0, 0.7)\";\n        ctx.fillText(txt, 4, 17);\n\n        let b64 = testCanvas.toDataURL(\"image/png\").replace(\"data:image/png;base64,\",\"\");\n        this.cashtippr.$(\"#ct-canvas\").remove();\n        if (typeof this.cashtippr.window.atob !== \"function\")\n            return \"\";\n        let binImage = this.cashtippr.window.atob(b64);\n        // CRC32 position: https://browserleaks.com/canvas#how-does-it-work 4 bytes from 16 to 12 byte from the end of file\n        let crc = this.bin2hex(binImage.slice(-16,-12));\n        return crc;\n    }\n\n    // TODO we could read a lot more properties from window.navigator. but better to value a visitors privacy\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    // https://gist.github.com/cythrawll/8603752\n    protected bin2hex(s: string): string {\n        // From: http://phpjs.org/functions\n        // +   original by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n        // +   bugfixed by: Onno Marsman\n        // +   bugfixed by: Linuxworld\n        // +   improved by: ntoniazzi (http://phpjs.org/functions/bin2hex:361#comment_177616)\n        // *     example 1: bin2hex('Kev');\n        // *     returns 1: '4b6576'\n        // *     example 2: bin2hex(String.fromCharCode(0x00));\n        // *     returns 2: '00'\n        let i, l, o = \"\", n;\n        s += \"\";\n\n        for (i = 0, l = s.length; i < l; i++) {\n            n = s.charCodeAt(i).toString(16)\n            o += n.length < 2 ? \"0\" + n : n;\n        }\n        return o;\n    }\n}\n","\nexport class SlpAddress {\n\n    /**\n     * Check if a BCH address is valid.\n     * @param bchAddress The address in CashAddress format starting with 'bitcoincash:'\n     */\n    public static isValidBchAddress(bchAddress: string): boolean {\n        if (!bchAddress)\n            return;\n        // TODO improve this by checking the actual address format\n        bchAddress = bchAddress.trim().toLowerCase();\n        if (/^bitcoincash:/.test(bchAddress) === false)\n            return false;\n        if (bchAddress.length !== 54)\n            return false;\n        let addressParts = bchAddress.split(\":\");\n        if (addressParts.length !== 2)\n            return false;\n        return /^[a-z0-9]+$/.test(addressParts[1]) === true;\n    }\n\n    /**\n     * Check if a SLP address is valid.\n     * @param slpAddress The address starting with 'simpleledger:'\n     */\n    public static isValidSlpAddress(slpAddress: string): boolean {\n        if (!slpAddress)\n            return;\n        // TODO improve this by checking the actual address format\n        slpAddress = slpAddress.trim().toLowerCase();\n        if (/^simpleledger:/.test(slpAddress) === false)\n            return false;\n        if (slpAddress.length !== 55)\n            return false;\n        let addressParts = slpAddress.split(\":\");\n        if (addressParts.length !== 2)\n            return false;\n        return /^[a-z0-9]+$/.test(addressParts[1]) === true;\n    }\n}\n","import {AbstractPayment, CashTippr} from \"./CashTippr\";\nimport {WebHelpers} from \"./WebHelpers\";\nimport {Order} from \"./structs/Order\";\nimport {AbstractModule} from \"./AbstractModule\";\n\n/**\n * Class to interact with the Woocommerce store of a WordPress installation.\n */\nexport class Woocommerce extends AbstractModule {\n    protected fullyPaid: boolean = false;\n    protected checkServerPaymentTimerID: number = 0;\n\n    constructor(cashtippr: CashTippr, webHelpers: WebHelpers) {\n        super(cashtippr, webHelpers);\n        this.cashtippr.$(this.cashtippr.window.document).ready(($) => {\n            const config = this.cashtippr.getConfig();\n            this.addButtonLinkClass();\n            // check payment stastus sooner on 1st page load to update remaining amount\n            if (config.checkPaymentIntervalSec > 0)\n                setTimeout(this.checkPaymentStatus.bind(this, true), /*config.checkPaymentIntervalSec*/1*1000);\n            //this.addPayButtonListener();\n\n            if (this.cashtippr.$(\"#ct-qrcode-form\").length !== 0)\n                this.addPaymentFormEvents(this.cashtippr.$(\"#ct-qrcode-form\").eq(0)); // the form after the order has been placed\n        });\n    }\n\n    public onPayment(payment: AbstractPayment) {\n        this.sendPaymentForValidation(payment);\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected sendPaymentForValidation(payment: AbstractPayment) {\n        const firstButton = this.cashtippr.$(\".ct-btn-wrap-top\"); // there can only be 1 Woocommerce payment button per payment method\n        let params = {\n            txid: payment.txid,\n            dbtxid: this.cashtippr.getPluginPaymentID(firstButton),\n            am: payment.amount\n        }\n        this.webHelpers.getApi(\"/wp-json/cashtippr-wc/v1/validate\", params, (data) => {\n            if (data.data.length === 1) {\n                this.cashtippr.window.document.location.assign(data.data[0].url);\n            }\n            // don't show an error message otherwise, because we likely just wait for more confirmations\n        });\n    }\n\n    protected addPaymentFormEvents(paymentFormEl: JQuery) {\n        this.cashtippr.addCopyInputListeners();\n    }\n\n    protected checkPaymentStatus(repeat = true) {\n        const config = this.cashtippr.getConfig();\n        if (config.nonce === undefined || config.orderID <= 0)\n            return;\n        let params = {\n            n: config.nonce,\n            oid: config.orderID\n        }\n        clearTimeout(this.checkServerPaymentTimerID);\n        this.webHelpers.getApi(\"/wp-json/cashtippr-wc/v1/order-status\", params, (data) => {\n            if (repeat === true && config.checkPaymentIntervalSec > 0) { // TODO abort checking after x minutes?\n                clearTimeout(this.checkServerPaymentTimerID); // ensure we don't have multiple timers running\n                this.checkServerPaymentTimerID = setTimeout(this.checkPaymentStatus.bind(this, true), config.checkPaymentIntervalSec * 1000);  // always repeat the check even if there was an error\n            }\n            if (data.error === true) {\n                this.cashtippr.window.console.error(\"Error checking BCH payment status: %s\", data.errorMsg);\n                return;\n            }\n            if (data.data && data.data.length >= 1) {\n                const order: Order = Object.assign(new Order(), data.data[0]);\n                if (order.status === \"paid\") {\n                    this.showPaymentReceived();\n                    return;\n                }\n                else if (order.bchAmountReceived > 0.0) {\n                    this.showPartialPayment(order);\n                    return;\n                }\n            }\n        });\n    }\n\n    protected showPartialPayment(order: Order) {\n        const numDecimals = this.cashtippr.getConfig().paymentCommaDigits;\n        const remainingAmount = order.calculateRemaningAmount().toFixed(numDecimals);\n        if (this.cashtippr.$(\"#ct-pay-amount-txt\").text() === remainingAmount)\n            return;\n        this.cashtippr.$(\"#ct-pay-amount-txt\").text(remainingAmount);\n        this.cashtippr.$(\"#ct-payment-remaining\").fadeIn(\"slow\");\n\n        // update payment amount in URI and QR code\n        this.cashtippr.$(\"#ct-qr-code-image\").attr(\"src\", order.qrcode);\n        this.cashtippr.$(\"#ct-address\").val(order.uri);\n        this.cashtippr.$(\"#ct-pay-app\").attr(\"href\", order.uri);\n        this.cashtippr.$(\".ct-badger-button\").attr(\"data-satoshis\", order.calculateRemaningAmount());\n    }\n\n    protected showPaymentReceived() {\n        if (this.fullyPaid === true)\n            return; // already updated\n        this.fullyPaid = true;\n        clearTimeout(this.checkServerPaymentTimerID);\n        this.cashtippr.$(\"#ct-payment-status\").text(this.cashtippr.getConfig().paidTxt);\n        this.cashtippr.$(\"#ct-payment-pending, #ct-pay-instructions, .ct-payment-option\").fadeOut(\"slow\");\n    }\n\n    protected addButtonLinkClass() {\n        const buttons = this.cashtippr.$(\"#ct-pay-app\");\n        if (buttons.length === 0)\n            return;\n        // try to find a native WP theme button style first\n        if (this.webHelpers.isExistingCssSelector(\"a.btn\") === true)\n            buttons.addClass(\"btn\");\n        else if (this.webHelpers.isExistingCssSelector(\"a.button\") === true)\n            buttons.addClass(\"button\");\n        else\n            buttons.addClass(\"ct-button-link\");\n    }\n}\n","\nexport type OrderStatus = \"pending\" | \"paid\";\n\n/**\n * Class representing properties to check if a WooCommerce order has been paid.\n */\nexport class Order {\n    public readonly id: number; // the unique ID for this order\n    public readonly nonce: string; // a nonce to authenticate REST API requests\n    public readonly status: OrderStatus;\n    public readonly bchAmount: number; // amount requested (total order value)\n    public readonly bchAmountReceived: number;\n    public readonly qrcode: string; // an image link to the QR code with the (remaining) amount to be paid\n    public readonly uri: string; // the payment URI\n\n    constructor() {\n    }\n\n    public calculateRemaningAmount(): number {\n        return Math.max(0.0, this.bchAmount - this.bchAmountReceived);\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n}\n","import {AbstractPayment, CashTippr} from \"./CashTippr\";\nimport {WebHelpers} from \"./WebHelpers\";\nimport {AbstractModule} from \"./AbstractModule\";\n\n\nexport class AdBlockDetect extends AbstractModule {\n    protected static loadedAdFrame = false;\n\n    constructor(cashtippr: CashTippr, webHelpers: WebHelpers) {\n        super(cashtippr, webHelpers);\n\n        // TODO add option to store and load adblock lib files from /uploads/{random-filename}.js (created by PHP)\n        this.cashtippr.$(this.cashtippr.window.document).ready(($) => {\n            if (this.cashtippr.$(\"body\").hasClass(\"wp-admin\") === true)\n                return; // don't run in admin panel\n            else if (this.cashtippr.getConfig().detect_adblock === false || this.cashtippr.getConfig().tipAmount > 0.0)\n                return;\n            this.loadLib();\n        });\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected loadLib() {\n        // We look at whether FuckAdBlock already exists.\n        const wnd: any = this.cashtippr.window;\n        if(this.cashtippr.getConfig().adblockNoConflict !== true && (typeof wnd.fuckAdBlock !== 'undefined' || typeof wnd.FuckAdBlock !== 'undefined')) {\n            // If this is the case, it means that something tries to usurp are identity\n            // So, considering that it is a detection\n            this.onAdBlockDetected();\n        }\n        else {\n            wnd.fuckAdBlock = null; // prevent automatic instantiation\n            const importFAB = this.cashtippr.window.document.createElement('script');\n            importFAB.onload = () => {\n                wnd.fuckAdBlock = new wnd.FuckAdBlock({\n                    checkOnLoad: true, // At launch, check if AdBlock is enabled // Uses the method fuckAdBlock.check()\n                    resetOnEnd: true, // At the end of the check, is that it removes all events added ?\n                    loopCheckTime: 55, // The number of milliseconds between each check\n                    loopMaxNumber: 6, // The number of negative checks after which there is considered that AdBlock is not enabled // Time (ms) = 50*(5-1) = 200ms (per default)\n                    baitClass: 'pub_300x250 pub_300x250m pub_728x90 text-ad textAd banner_ad text_ad text_ads text-ads text-ad-links', // CSS class used by the bait caught AdBlock\n                    baitStyle: 'width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;', // CSS style used to hide the bait of the users\n                    debug: false, // Displays the debug in the console (available only from version 3.2 and more)\n                });\n\n                // If all goes well, we configure FuckAdBlock\n                wnd.fuckAdBlock.onDetected(this.onAdBlockDetected.bind(this));\n                wnd.fuckAdBlock.onNotDetected(this.onAdBlockNotDetected.bind(this));\n            };\n            importFAB.onerror = () => {\n                // If the script does not load (blocked, integrity error, ...)\n                // Then a detection is triggered\n                this.onAdBlockDetected();\n            };\n            importFAB.integrity = 'sha256-f5s2H2XgAi/4M/ipOOw8pxmim1o7cTOWL72QbKu0lSc=';\n            importFAB.crossOrigin = 'anonymous';\n            importFAB.src = this.cashtippr.getConfig().adBlockScript;\n            this.cashtippr.window.document.head.appendChild(importFAB);\n        }\n    }\n\n    public onPayment(payment: AbstractPayment) {\n        //this.cashtippr.$(\".dialog-adbl\").remove(); // better reload the page because we don't know if the webmaster modified it more with our JS callback\n        this.cashtippr.window.document.location.reload();\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected onAdBlockNotDetected(secondTry: boolean = false) {\n        //console.log('AdBlock is not enabled');\n        if (secondTry === false)\n            this.loadAdFrame();\n    }\n\n    protected onAdBlockDetected(secondTry: boolean = false) {\n        //console.log('AdBlock is enabled');\n        const wnd: any = this.cashtippr.window;\n        if (typeof wnd === \"function\")\n            wnd.ctipAdblockDetected();\n        // blank out the page immediately, even if a version of adblock tries to block the AJAX request below\n        const disablePage = this.cashtippr.getConfig().adblockDisable === true;\n        if (disablePage === true) {\n            let dialog = this.webHelpers.translate(this.cashtippr.$(\"#ct-modal-adblock-dialog-tpl\").html(), {\n                dialog_class: \"dialog-adbl\",\n                title: \"\",\n                text: \"\"\n            });\n            this.cashtippr.$(\"body\").append(dialog); // its position is fixed relative to the viewport\n        }\n        let data = {\n            msg: disablePage === true ? \"1\" : \"0\"\n        }\n        this.webHelpers.getApi(\"/wp-json/cashtippr/v1/get-post-notice\", data, (data) => { // always call this to fire PHP adblock detection hook\n            this.cashtippr.$(\".dialog-adbl\").remove(); // we have to add it with content or else it doesn't resize properly\n            if (disablePage !== true)\n                return;\n            if (data.error === true) {\n                this.cashtippr.$(\"#ct-adbl-title\").text(data.errorMsg);\n                //this.cashtippr.$(\"#ct-adbl-content\").html();\n                return;\n            }\n            const postTitle = data.data[0].post.title;\n            const postContent = data.data[0].post.content;\n            let dialog = this.webHelpers.translate(this.cashtippr.$(\"#ct-modal-adblock-dialog-tpl\").html(), {\n                dialog_class: \"dialog-adbl\",\n                title: postTitle,\n                text: postContent\n            }, true);\n            this.cashtippr.$(\"body\").append(dialog);\n            // TODO generate 1-time addresses and enable qr-code. then check with WP cron for payment and store in session\n            this.cashtippr.$(\"#ct-modal-adblock-dialog .ct-qrcode-wrap\").css(\"display\", \"none\");\n        });\n    }\n\n    protected loadAdFrame() {\n        if (AdBlockDetect.loadedAdFrame === true)\n            return;\n        AdBlockDetect.loadedAdFrame = true;\n        const importScript = this.cashtippr.window.document.createElement('script');\n        const wnd: any = this.cashtippr.window;\n        importScript.onload = () => {\n            setTimeout(() => { // delay check to be sure it's evaluated\n                if (wnd.ctipAdblockOk !== true)\n                    this.onAdBlockDetected(true);\n                else\n                    this.onAdBlockNotDetected(true);\n            }, 100);\n        };\n        importScript.onerror = () => {\n            this.onAdBlockDetected(true);\n        };\n        importScript.integrity = 'sha256-YrKAEKiVnq8uOpnEBYck9fbjgMBcJgjFcltgKGhtpkA=';\n        importScript.crossOrigin = 'anonymous'; // not really needed here\n        importScript.src = this.cashtippr.getConfig().adFrameBaitUrl;\n        this.cashtippr.window.document.head.appendChild(importScript);\n    }\n}\n","import {AbstractModule} from \"../AbstractModule\";\nimport {CashTippr} from \"../CashTippr\";\nimport {SlpSDK} from \"../SlpSDK\";\nimport {ReaderTokens} from \"../structs/ReaderTokens\";\n\nexport class AdminControls extends AbstractModule {\n    protected static readonly QUERY_TOKEN_INTERVAL_MS = 1500;\n    protected static readonly BCH_BALANCE_LOW = 0.0005;\n\n    protected slpSDK: SlpSDK = null;\n    protected distributingTokens: boolean = false;\n    protected queryPayoutsTimerID: number = 0;\n    protected walletImportOpen = false;\n\n    constructor(cashtippr: CashTippr) {\n        super(cashtippr);\n    }\n\n    public init() {\n        if (this.cashtippr.$(\"body\").attr(\"class\").indexOf(\"cashtippr\") === -1)\n            return; // not our plugin settings page\n\n        this.cashtippr.getTooltips().initToolTips();\n        this.cashtippr.$(this.cashtippr.window.document).ready(($) => {\n            this.enableAdblockSettings();\n            this.enableSlpPressForPosts(this.cashtippr.window.document.getElementById(\"cashtippr_settings[enable_specific_pages]\"), true);\n            this.enableSlpPressForPosts(this.cashtippr.window.document.getElementById(\"cashtippr_settings[enable_specific_posts]\"), false);\n        });\n        this.cashtippr.$(\"#cashtippr_settings\\\\[detect_adblock\\\\]\").on(\"change\", (event) => {\n            this.enableAdblockSettings();\n        });\n\n        // SLP Press\n        if (this.cashtippr.$(\"#cashtippr_settings\\\\[create_new_wallet\\\\]\").length !== 0)\n            this.slpSDK = new SlpSDK(this.cashtippr);\n        this.toggleWalletCreateControls();\n        this.toggleSendingTokenState();\n        if (this.cashtippr.getAdminConfig().adminSlpWallet) {\n            this.displayWalletBalance(this.cashtippr.getAdminConfig().adminSlpWallet);\n            this.displayBchWalletBalance();\n        }\n        this.cashtippr.$(\"#cashtippr_settings\\\\[enable_specific_pages\\\\]\").on(\"change\", (event) => {\n            this.enableSlpPressForPosts(event.target, true);\n        });\n        this.cashtippr.$(\"#cashtippr_settings\\\\[enable_specific_posts\\\\]\").on(\"change\", (event) => {\n            this.enableSlpPressForPosts(event.target, false);\n        });\n\n        this.cashtippr.$(\"#cashtippr_settings\\\\[create_new_wallet\\\\]\").on(\"click\", (event) => {\n            if (this.isTokenConfigured() === false) {\n                this.cashtippr.window.alert(this.cashtippr.getAdminConfig().distributeTokens.tr.configureToken);\n                return;\n            }\n            this.createWallet();\n        });\n        this.cashtippr.$(\"#cashtippr_settings\\\\[import_wallet\\\\]\").on(\"click\", (event) => {\n            if (this.isTokenConfigured() === false) {\n                this.cashtippr.window.alert(this.cashtippr.getAdminConfig().distributeTokens.tr.configureToken);\n                return;\n            }\n            this.cashtippr.$(\"#ct-wallet-import-controls\").fadeToggle(\"slow\");\n            this.walletImportOpen = !this.walletImportOpen;\n            if (this.walletImportOpen === true)\n                this.cashtippr.$(\".ct-import-wallet-input\").prop(\"required\", true);\n            else\n                this.cashtippr.$(\".ct-import-wallet-input\").removeProp(\"required\");\n        });\n        //this.cashtippr.$(\"#ct-input-slp-admin-wallet-form\").on(\"submit\", (event) => { // already inside a form\n        this.cashtippr.$(\"#ct-btn-import-wallet\").on(\"click\", (event) => {\n            // event.preventDefault();\n            this.importWallet(this.cashtippr.$(\"#ct-wallet-address-import\").val(), this.cashtippr.$(\"#ct-wallet-passphrase-import\").val());\n        });\n        this.cashtippr.$(\"#cashtippr_settings\\\\[delete_wallet\\\\]\").on(\"click\", async (event) => {\n            if (this.cashtippr.window.confirm(this.cashtippr.getAdminConfig().distributeTokens.tr.confirmDeleteWallet) !== true)\n                return;\n            await this.deleteWallet();\n            this.toggleWalletCreateControls();\n        });\n        this.cashtippr.$(\"#cashtippr_settings\\\\[start_distribution\\\\]\").on(\"click\", (event) => {\n            this.distributingTokens = true;\n            this.toggleSendingTokenState();\n            this.scheduleQueryTokenDistribution();\n            this.cashtippr.$(this.cashtippr.window).bind(\"beforeunload\", (e) => {\n                return this.cashtippr.getAdminConfig().distributeTokens.tr.laavePage; // message not shown by modern browsers\n            });\n        });\n        this.cashtippr.$(\"#cashtippr_settings\\\\[stop_distribution\\\\]\").on(\"click\", (event) => {\n            this.distributingTokens = false;\n            this.toggleSendingTokenState();\n            clearTimeout(this.queryPayoutsTimerID);\n            this.cashtippr.$(this.cashtippr.window).unbind(\"beforeunload\");\n        });\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected enableAdblockSettings() {\n        const enabled = this.cashtippr.$(\"#cashtippr_settings\\\\[detect_adblock\\\\]\").is(\":checked\") === true;\n        const adblockSettingsSelector = \"#cashtippr_settings\\\\[adblockDisable\\\\], #cashtippr_settings\\\\[adblock_page\\\\], #cashtippr_settings\\\\[adblockNoConflict\\\\]\";\n        if (enabled === false)\n            this.cashtippr.$(adblockSettingsSelector).prop(\"disabled\", true);\n        else\n            this.cashtippr.$(adblockSettingsSelector).removeProp(\"disabled\");\n    }\n\n    // SLP Press\n    protected enableSlpPressForPosts(checkboxElement: Element, pages: boolean) {\n        const enabled = this.cashtippr.$(checkboxElement).is(\":checked\") === true;\n        const settingsSelector = pages === true ? \"#cashtippr_settings\\\\[slp_press_pages\\\\]\" : \"#cashtippr_settings\\\\[slp_press_posts\\\\]\";\n        if (enabled === false)\n            this.cashtippr.$(settingsSelector).prop(\"disabled\", true);\n        else\n            this.cashtippr.$(settingsSelector).removeProp(\"disabled\");\n    }\n\n    protected async createWallet() {\n        let wallet = await this.slpSDK.createWallet();\n        await this.storeWallet(wallet.address, wallet.addressSlp, wallet.mnemonic);\n        this.cashtippr.$(\"#ct-wallet-create-result\").fadeIn(\"slow\");\n        this.cashtippr.$(\"#ct-slp-address\").val(wallet.addressSlp);\n        this.cashtippr.$(\"#ct-wallet-address-bch\").val(wallet.address);\n        this.cashtippr.$(\"#ct-wallet-passphrase\").val(wallet.mnemonic);\n        this.toggleWalletCreateControls();\n        this.displayWalletBalance(wallet.address);\n        this.displayBchWalletBalance();\n    }\n\n    protected async importWallet(address: string, passphrase: string) {\n        if (await this.slpSDK.loginToWallet(address, passphrase, true) === false) {\n            this.cashtippr.window.alert(this.cashtippr.getAdminConfig().distributeTokens.tr.invalidPassphrase);\n            return;\n        }\n        const addresses = await this.slpSDK.getWalletAddresses(passphrase, 1);\n        await this.storeWallet(addresses.address, address, passphrase);\n        this.cashtippr.getAdminConfig().distributeTokens.admin.addressBch = addresses.address;\n        this.cashtippr.$(\"#ct-import-message\").text(this.cashtippr.getAdminConfig().distributeTokens.tr.importOk);\n        this.toggleWalletCreateControls();\n        this.displayWalletBalance(address);\n        this.displayBchWalletBalance();\n    }\n\n    protected async displayWalletBalance(address: string) {\n        let balance = await this.slpSDK.getTokenBalance(address, this.cashtippr.getAdminConfig().distributeTokens.id);\n        this.cashtippr.$(\"#ct-balance-amount\").text(balance); // TODO token decimals?\n        if (balance < this.cashtippr.getAdminConfig().distributeTokens.amountLow)\n            this.cashtippr.$(\"#ct-slp-balance\").addClass(\"ct-slp-low-balance\");\n    }\n\n    protected async displayBchWalletBalance() {\n        //let balance = await this.slpSDK.getBalanceByKey(this.cashtippr.getAdminConfig().distributeTokens.admin.mnemonic); // always display 1st BCH address balance\n        let balance = await this.slpSDK.getBalance(this.cashtippr.getAdminConfig().distributeTokens.admin.addressBch);\n        this.cashtippr.$(\"#ct-bch-amount\").text(balance.toFixed(8));\n        if (balance < AdminControls.BCH_BALANCE_LOW)\n            this.cashtippr.$(\"#ct-bch-balance\").addClass(\"ct-slp-low-balance\");\n    }\n\n    protected storeWallet(bchAddress: string, slpAddress: string, mnemonic: string) {\n        return new Promise<void>((resolve, reject) => {\n            let params = {\n                address: slpAddress,\n                addressBch: bchAddress,\n                passphrase: mnemonic,\n                n: this.cashtippr.getAdminConfig().distributeTokens.admin.token\n            }\n            this.webHelpers.postApi(\"/wp-json/cashtippr-slp-press/v1/add-create-wallet\", params, (data) => {\n                if (data.error === true) {\n                    this.cashtippr.window.console.error(\"CashTippr: Error adding admin SLP wallet:\", data);\n                    return reject({txt: \"error adding admin wallet\", res: data});\n                }\n                this.cashtippr.getAdminConfig().adminSlpWallet = slpAddress;\n                resolve();\n            });\n        });\n    }\n\n    protected deleteWallet() {\n        return new Promise<void>((resolve, reject) => {\n            let params = {\n                n: this.cashtippr.getAdminConfig().distributeTokens.admin.token\n            }\n            this.webHelpers.postApi(\"/wp-json/cashtippr-slp-press/v1/delete-wallet\", params, (data) => {\n                if (data.error === true) {\n                    this.cashtippr.window.console.error(\"CashTippr: Error deleting admin SLP wallet:\", data);\n                    return reject({txt: \"error deleting admin wallet\", res: data});\n                }\n                this.cashtippr.getAdminConfig().adminSlpWallet = undefined;\n                resolve();\n            });\n        });\n    }\n\n    protected toggleWalletCreateControls() {\n        const conf = this.cashtippr.getAdminConfig();\n        if (conf.adminSlpWallet == \"\" || conf.adminSlpWallet === undefined) {\n            this.cashtippr.$(\"#ct-address-balances\").fadeOut(\"slow\");\n            this.cashtippr.$(\"#cashtippr_settings\\\\[create_new_wallet\\\\], #cashtippr_settings\\\\[import_wallet\\\\]\").parent().fadeIn(\"slow\");\n            this.cashtippr.$(\"#cashtippr_settings\\\\[delete_wallet\\\\]\").parent().fadeOut(\"slow\");\n        }\n        else {\n            this.cashtippr.$(\"#ct-address-balances\").fadeIn(\"slow\");\n            this.cashtippr.$(\"#cashtippr_settings\\\\[create_new_wallet\\\\], #cashtippr_settings\\\\[import_wallet\\\\]\").parent().fadeOut(\"slow\");\n            this.cashtippr.$(\"#cashtippr_settings\\\\[delete_wallet\\\\]\").parent().fadeIn(\"slow\");\n        }\n    }\n\n    protected toggleSendingTokenState() {\n        if (this.distributingTokens === false) {\n            this.cashtippr.$(\"#ct-sending-activity\").fadeOut(\"slow\");\n            this.cashtippr.$(\"#cashtippr_settings\\\\[start_distribution\\\\]\").prop(\"disabled\", false);\n            this.cashtippr.$(\"#cashtippr_settings\\\\[stop_distribution\\\\]\").prop(\"disabled\", true);\n        }\n        else {\n            this.cashtippr.$(\"#ct-sending-activity\").fadeIn(\"slow\");\n            this.cashtippr.$(\"#cashtippr_settings\\\\[start_distribution\\\\]\").prop(\"disabled\", true);\n            this.cashtippr.$(\"#cashtippr_settings\\\\[stop_distribution\\\\]\").prop(\"disabled\", false);\n        }\n    }\n\n    protected isTokenConfigured(): boolean {\n        let conf = this.cashtippr.getConfig().distributeTokens; // only available outside WP-Admin\n        if (conf === undefined)\n            conf = this.cashtippr.getAdminConfig().distributeTokens;\n        return conf.id != \"\" && conf.ticker != \"\";\n    }\n\n    protected async sendTokens(tokens: ReaderTokens[]): Promise<void> {\n        if (tokens.length === 0)\n            return;\n        const conf = this.cashtippr.getAdminConfig().distributeTokens;\n        const ticker = conf.ticker;\n        let errors = false;\n        for (let i = 0; i < tokens.length; i++)\n        {\n            this.addLogLine(`Sending ${tokens[i].amount} ${ticker} to ${tokens[i].address} ...` , false);\n            let sent = await this.slpSDK.sendToken(conf.admin.mnemonic, tokens[i].address, conf.id, tokens[i].amount);\n            if (sent === true) {\n                this.addLogLine(\" Done\", true);\n                await this.notifyTokenSent(tokens[i]);\n            }\n            else {\n                this.addLogLine(\" Error\", true);\n                errors = true;\n            }\n        }\n        if (errors === true) {\n            this.cashtippr.$(\"#ct-send-token-error\").fadeIn(\"slow\");\n            throw new Error(\"Error broadcasting TX to send tokens\");\n        }\n        else {\n            this.cashtippr.$(\"#ct-send-token-error\").fadeOut(\"slow\");\n            this.displayWalletBalance(this.cashtippr.getAdminConfig().adminSlpWallet);\n            this.displayBchWalletBalance();\n        }\n    }\n\n    protected notifyTokenSent(token: ReaderTokens) {\n        return new Promise<void>((resolve, reject) => {\n            let params = {\n                id: token.id,\n                auth: this.cashtippr.getAdminConfig().slpDistributeNonce\n            }\n            this.webHelpers.getApi(\"/wp-json/cashtippr-slp-press/v1/notify-sent\", params, async (data) => {\n                if (data.error === true) {\n                    return reject({txt: \"Error notifying sent tokens\", res: data});\n                }\n                //data.data[0].ok === true\n                resolve();\n            });\n        })\n    }\n\n    protected queryTokenDistribution() {\n        return new Promise<void>((resolve, reject) => {\n            clearTimeout(this.queryPayoutsTimerID);\n            let params = {\n                auth: this.cashtippr.getAdminConfig().slpDistributeNonce\n            }\n            this.webHelpers.getApi(\"/wp-json/cashtippr-slp-press/v1/query-distribution\", params, async (data) => {\n                if (data.error === true) {\n                    this.scheduleQueryTokenDistribution();\n                    this.cashtippr.window.console.error(\"CashTippr: Error deleting admin SLP wallet:\", data);\n                    return reject({txt: \"error deleting admin wallet\", res: data});\n                }\n                let tokens = [];\n                for (let i = 0; i < data.data.length; i++)\n                    tokens.push(ReaderTokens.fromJson(data.data[i]));\n                try {\n                    await this.sendTokens(tokens);\n                    this.scheduleQueryTokenDistribution();\n                }\n                catch (err) {\n                    this.scheduleQueryTokenDistribution(20*1000);\n                    this.cashtippr.window.console.error(\"Error sending tokens\", err);\n                }\n                resolve();\n            }).fail((err) => {\n                this.cashtippr.window.console.error(\"CashTippr: Error querying SLP tokens to distribute:\", err);\n                this.scheduleQueryTokenDistribution();\n            });\n        })\n    }\n\n    protected scheduleQueryTokenDistribution(delayMs: number = 0) {\n        clearTimeout(this.queryPayoutsTimerID);\n        if (this.distributingTokens === false)\n            return; // user pressed \"stop\" during request\n        this.queryPayoutsTimerID = setTimeout(() => {\n            this.queryTokenDistribution();\n        }, AdminControls.QUERY_TOKEN_INTERVAL_MS + delayMs)\n    }\n\n    protected addLogLine(line: string, lineBreak: boolean = false) {\n        if (lineBreak === true)\n            line += \"\\r\\n\";\n        this.cashtippr.$(\"#ct-distribution-log\").append(line);\n        this.cashtippr.$(\"#ct-distribution-log\").scrollTop(this.cashtippr.$(\"#ct-distribution-log\")[0].scrollHeight);\n    }\n}\n","import {AbstractModule} from \"./AbstractModule\";\nimport {CashTippr} from \"./CashTippr\";\n\nexport interface ICreateWalletResult {\n    address: string;\n    addressSlp: string;\n    mnemonic: string;\n    addressList: string[]; // an array of all addresses created (if multiple). the 1st address is the same as 'address'\n    addressListSlp: string[];\n}\n\nexport class SlpSDK extends AbstractModule {\n    protected static readonly CREATE_ADDRESS_COUNT = 10;\n    protected static readonly CHECK_ADDRESS_COUNT = 100;\n\n    protected className: string;\n    protected slp: any;\n    protected mnemonicLanguage = \"english\"; // TODO set this depending on user locale\n    protected config = {\n        testnet: false,\n        //restUrl: \"https://trest.bitcoin.com/v2/\" // testnet\n        restUrl: \"https://rest.bitcoin.com/v2/\"\n    }\n\n    constructor(cashtippr: CashTippr) {\n        super(cashtippr);\n        this.className = this.constructor[\"name\"];\n        const wnd: any = window;\n        this.slp = new wnd.ekliptor.blockchainAPI.SLP({restURL: this.config.restUrl});\n\n        // https://github.com/Bitcoin-com/wormhole-sdk/blob/master/examples/create-wallet/create-wallet.js\n        //const that = this; // getInfo() is another scope\n        this.slp.Blockchain.getBlockchainInfo().then((result) => {\n            this.cashtippr.window.console.debug(\"Connected to %s blockchain %o\", this.className, result);\n        }).catch((err) => {\n            this.cashtippr.window.console.error(\"Failed to connect to %s blockchain %o\", this.className, err);\n        })\n    }\n\n    public async createWallet(/*slpAddress: boolean*/): Promise<ICreateWalletResult> {\n        // create 128 bit BIP39 mnemonic\n        const mnemonic = this.slp.Mnemonic.generate(/*256*/128, this.slp.Mnemonic.wordLists()[this.mnemonicLanguage]);\n        // TODO generate entropy? https://developer.bitcoin.com/slp/docs/js/hdnode\n\n        // root seed buffer\n        const rootSeed = this.slp.Mnemonic.toSeed(mnemonic)\n\n        // master HDNode\n        //const config = await this.loadConfig();\n        let masterHDNode\n        try {\n            //masterHDNode = config.node.slp.testnet ? this.slp.HDNode.fromSeed(rootSeed, \"testnet\") : this.slp.HDNode.fromSeed(rootSeed);\n            masterHDNode = this.slp.HDNode.fromSeed(rootSeed, this.config.testnet ? \"testnet\" : undefined);\n        } catch (err) { // TODO currently issues with bitcoincashjs-lib in browser, working in node https://github.com/Bitcoin-com/slp-sdk/issues/76\n            // @ts-ignore\n            return null;\n        }\n\n        // HDNode of BIP44 account\n        //const account = this.wormhole.HDNode.derivePath(masterHDNode, \"m/44'/145'/0'\")\n\n        let addrsses: string[] = [];\n        let addrssesSlp: string[] = [];\n        for (let i = 0; i < SlpSDK.CREATE_ADDRESS_COUNT; i++)\n        {\n            const childNode = masterHDNode.derivePath(`m/44'/145'/0'/0/${i}`);\n            addrsses.push(this.slp.HDNode.toCashAddress(childNode));\n            addrssesSlp.push(this.slp.HDNode.toSLPAddress(childNode));\n\n            // Save the first seed address for use\n            /*\n            if (i === 0) {\n                //outObj.legacyAddress = this.slp.HDNode.toLegacyAddress(childNode)\n            }\n            */\n        }\n\n        // derive the first external change address HDNode which is going to spend utxo\n        //const change = this.slp.HDNode.derivePath(account, \"0/0\");\n\n        // get the cash address\n        //let cashAddr = this.slp.HDNode.toCashAddress(change)\n\n        return {\n            address: addrsses[0],\n            addressSlp: addrssesSlp[0],\n            mnemonic: mnemonic,\n            addressList: addrsses,\n            addressListSlp: addrssesSlp\n        };\n    }\n\n    public async loginToWallet(address: string, mnemonic: string, slp: boolean): Promise<boolean> {\n        // TODO check with Mnemonic.validate() first?\n        // root seed buffer\n        const rootSeed = this.slp.Mnemonic.toSeed(mnemonic)\n\n        // master HDNode\n        const masterHDNode = this.slp.HDNode.fromSeed(rootSeed, this.config.testnet ? \"testnet\" : undefined)\n\n        // HDNode of BIP44 account\n        //const account = this.slp.HDNode.derivePath(masterHDNode, \"m/44'/145'/0'\")\n        for (let i = 0; i < SlpSDK.CHECK_ADDRESS_COUNT; i++)\n        {\n            const childNode = masterHDNode.derivePath(`m/44'/145'/0'/0/${i}`);\n            let curAddress = slp === true ? this.slp.HDNode.toSLPAddress(childNode) : this.slp.HDNode.toCashAddress(childNode);\n            if (curAddress === address)\n                return true;\n        }\n        return false;\n    }\n\n    public async getWalletAddresses(mnemonic: string, numberAddresses: number = -1): Promise<ICreateWalletResult> {\n        // root seed buffer\n        const rootSeed = this.slp.Mnemonic.toSeed(mnemonic)\n\n        // master HDNode\n        let masterHDNode\n        try {\n            masterHDNode = this.slp.HDNode.fromSeed(rootSeed, this.config.testnet ? \"testnet\" : undefined);\n        } catch (err) {\n            // @ts-ignore\n            return null;\n        }\n\n        let addrsses: string[] = [];\n        let addrssesSlp: string[] = [];\n        if (numberAddresses === -1)\n            numberAddresses = SlpSDK.CREATE_ADDRESS_COUNT;\n        for (let i = 0; i < numberAddresses; i++)\n        {\n            const childNode = masterHDNode.derivePath(`m/44'/145'/0'/0/${i}`);\n            addrsses.push(this.slp.HDNode.toCashAddress(childNode));\n            addrssesSlp.push(this.slp.HDNode.toSLPAddress(childNode));\n        }\n\n        return {\n            address: addrsses[0],\n            addressSlp: addrssesSlp[0],\n            mnemonic: mnemonic,\n            addressList: addrsses,\n            addressListSlp: addrssesSlp\n        };\n    }\n\n    public async getBalanceByKey(mnemonic: string): Promise<number> {\n        // root seed buffer\n        const rootSeed = this.slp.Mnemonic.toSeed(mnemonic)\n\n        // master HDNode\n        const masterHDNode = this.slp.HDNode.fromSeed(rootSeed, this.config.testnet ? \"testnet\" : undefined)\n\n        // HDNode of BIP44 account\n        //const account = this.slp.HDNode.derivePath(masterHDNode, \"m/44'/145'/0'\")\n        const childNode = masterHDNode.derivePath(`m/44'/145'/0'/0/0`);\n\n        //const change = this.slp.HDNode.derivePath(account, \"0/0\")\n        const address = this.slp.HDNode.toCashAddress(childNode);\n\n        // get the cash address\n        //const cashAddress = this.slp.HDNode.toCashAddress(change)\n        //const slpAddress = SLP.Address.toSLPAddress(cashAddress)\n        return this.getBalance(address);\n    }\n\n    public async getBalance(cashAddress: string): Promise<number> {\n        try {\n            // get BCH balance\n            const balance = await this.slp.Address.details(cashAddress)\n            if (!balance || balance.balance < 0.0)\n                return 0.0;\n            /**\n             * balance: 0.00000546\n             balanceSat: 546\n             totalReceived: 0.00000546\n             totalReceivedSat: 546\n             totalSent: 0\n             totalSentSat: 0\n             unconfirmedBalance: 0\n             unconfirmedBalanceSat: 0\n             unconfirmedTxApperances: 0\n             txApperances: 1\n             transactions: [\"5951d4da192907a133a5f615e4e75abe586dad2972a7188722e9c5551582d8c8\"]\n             legacyAddress: \"18qirAFiEYTr16EQcN9fCsENQJheBxUZdj\"\n             cashAddress: \"bitcoincash:qp2ll3maq7668s2a9hvae7p6qkkqrzzm0s3s359hx2\"\n             slpAddress: \"simpleledger:qp2ll3maq7668s2a9hvae7p6qkkqrzzm0sat60shc5\"\n             currentPage: 0\n             pagesTotal: 1\n             */\n            return balance.balance;\n\n        } catch (err) {\n            this.cashtippr.window.console.error(`Error in getBalance: `, err)\n            return 0.0;\n        }\n    }\n\n    public async getTokenBalance(slpAddress: string, tokenID: string): Promise<number> {\n        try {\n            const tokens = await this.slp.Utils.balancesForAddress(slpAddress);\n            if (Array.isArray(tokens) === false)\n                return 0.0;\n            /**\n             * [{}tokenId: \"7278363093d3b899e0e1286ff681bf50d7ddc3c2a68565df743d0efc54c0e7fd\"\n             balance: 10000\n             balanceString: \"10000\"\n             slpAddress: \"simpleledger:qp2ll3maq7668s2a9hvae7p6qkkqrzzm0sat60shc5\"\n             decimalCount: 8}, ... ]\n             */\n            for (let i = 0; i < tokens.length; i++)\n            {\n                if (tokens[i].tokenId !== tokenID)\n                    continue;\n                return tokens[i].balance;\n            }\n            return 0.0;\n        }\n        catch (err) {\n            this.cashtippr.window.console.error(\"Error getting token balances:\", err);\n            return 0.0;\n        }\n    }\n\n    public async sendToken(mnemonic: string, toSlpAddress: string, tokenID: string, tokenAmount: number): Promise<boolean> {\n        try {\n            // root seed buffer\n            const rootSeed = this.slp.Mnemonic.toSeed(mnemonic)\n\n            // master HDNode\n            const masterHDNode = this.slp.HDNode.fromSeed(rootSeed, this.config.testnet ? \"testnet\" : undefined)\n\n            // HDNode of BIP44 account\n            const account = this.slp.HDNode.derivePath(masterHDNode, \"m/44'/145'/0'\")\n            const change = this.slp.HDNode.derivePath(account, \"0/0\")\n\n            // get the cash address\n            const cashAddress = this.slp.HDNode.toCashAddress(change)\n            const slpAddress = this.slp.HDNode.toSLPAddress(change)\n\n            const fundingAddress = slpAddress\n            const fundingWif = this.slp.HDNode.toWIF(change) // <-- compressed WIF format\n            const tokenReceiverAddress = toSlpAddress;\n            const bchChangeReceiverAddress = cashAddress\n\n            // Create a config object for minting\n            const sendConfig = {\n                fundingAddress,\n                fundingWif,\n                tokenReceiverAddress,\n                bchChangeReceiverAddress,\n                tokenId: tokenID,\n                amount: tokenAmount\n            }\n\n            // Generate, sign, and broadcast a hex-encoded transaction for sending the tokens.\n            const sendTxId = await this.slp.TokenType1.send(sendConfig);\n            return sendTxId != \"\";\n        }\n        catch (err) {\n            this.cashtippr.window.console.error(`Error in sendToken: `, err)\n            return false;\n        }\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n}\n","\nexport class ReaderTokens {\n    public readonly id: number;\n    public amount: number;\n    public address: string;\n\n    constructor(id: number) {\n        this.id = typeof id === \"number\" ? id : parseInt(id);\n    }\n\n    public static fromJson(json: any): ReaderTokens {\n        let token = new ReaderTokens(json.id);\n        token.amount = parseFloat(json.amount);\n        token.address = json.address;\n        return token;\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n}\n"],"sourceRoot":""}