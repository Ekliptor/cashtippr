{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/CashTippr.ts","webpack:///./index.ts","webpack:///./src/admin/Tooltips.ts","webpack:///./src/WebHelpers.ts","webpack:///./src/BlurryImage.ts","webpack:///./src/Shout.ts","webpack:///./src/QrCode.ts","webpack:///./src/BadgerWallet.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Tooltips_1","WebHelpers_1","BlurryImage_1","Shout_1","QrCode_1","BadgerWallet_1","CashTippr","window","$","_this","this","tooltips","Tooltips","config","consentCookieName","CONSENT_COOKIE_NAME","confirmCookiesMsg","CONFIRM_COOKIES_MSG","confirmCookiesBtn","CONFIRM_COOKIES_BTN","webHelpers","WebHelpers","badger","BadgerWallet","qr","QrCode","blurryImage","BlurryImage","shout","Shout","document","ready","initToolTips","checkCookieConsent","toSatoshis","bch","Math","floor","getConfig","getWebHelpers","cashtippr","jQuery","e","that","tsfL10n","debug","touchBuffer","inTouchBuffer","setEvents","target","unset","touchEvents","$target","off","body","on","mousemove","mouseMove","mouseleave","mouseLeave","mouseout","touchRemove","updateDesc","event","classList","contains","tooltipText","querySelector","Element","innerHTML","dataset","desc","$tooltip","find","$arrow","overflow","data","overflowDir","parseInt","isNaN","round","css","pagex","originalEvent","pageX","$hoverItemWrap","closest","mousex","offset","left","arrowWidth","$textWrap","textWrapWidth","outerWidth","adjust","adjustDir","boundaryRight","arrowBoundary","remove","clearTimeout","setTimeout","$keepBalloon","hasClass","$children","children","length","not","loadToolTip","isTouch","type","$hoverItem","title","append","$boundary","tooltipHeight","outerHeight","tooltipTop","top","prop","addClass","$innerText","hoverItemWrapWidth","width","textWidth","textLeft","textRight","boundaryLeft","horIndent","basis","indent","right","mouseEnter","item","_event","Event","console","log","trigger","stopPropagation","initTooltips","$wrap","addTooltipBoundary","_triggerTooltipReset","_triggerTooltipUpdate","getBrowserLang","navigator","language","substr","toLowerCase","getCookie","c_name","x","y","ARRcookies","cookie","split","indexOf","replace","decodeURI","setCookie","expireDays","date","Date","getTime","cookieLifeDays","toUTCString","cookiePath","removeCookie","click","confirmCookies","fromBase64","atob","error","toBase64","btoa","translate","text","variables","safeHtml","toString","start","end","charAt","placeHolder","substring","translation","tr","textPiece","escapeOutput","reg","RegExp","match","convertNewlines","escapeRegex","str","args","arguments","isAppleIOS","test","userAgent","MSStream","getApi","path","callback","dataType","undefined","url","siteUrl","textStatus","jqXHR","scheduleUpdateTimerID","updateRemainingChars","addEventListeners","addConfirmDeleteMessages","onPayment","payment","domID","parent","submit","forms","each","index","formEl","val","remaining","fadeOut","fadeIn","keyup","scheduleCharsUpdate","change","question","confirm","preventDefault","showQrDialog","paymentButtonlWrapper","txid","attr","paymentCtrlWrapper","amount","params","am","dialog","html","dialog_class","errorMsg","inputEl","select","execCommand","err","CashTippr_1","globalCallbacks","onBadgerPayment","sendPaymentReceived","updateButtonAmount","buttonData","buttonDataObj","JSON","parse","buttonId","show_search_engines","days","postHide","res","location","reload","btnContainer","btn","amountNewUserCurrency","parseFloat","Number","NaN","currency","display_currency","amountSats","rate"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","import {Tooltips} from \"./admin/Tooltips\";\nimport {WebHelpers, WebHelpersConfig} from \"./WebHelpers\";\nimport {BlurryImage} from \"./BlurryImage\";\nimport {Shout} from \"./Shout\";\nimport {QrCode} from \"./QrCode\";\nimport {BadgerWallet} from \"./BadgerWallet\";\n\nexport interface BitcoinCashConversionRate {\n    [fiatCurrency: string]: number;\n}\nexport interface CashTipprConfig extends WebHelpersConfig {\n    // same keys as in php\n    show_search_engines: boolean;\n    display_currency: string;\n    rate: BitcoinCashConversionRate;\n}\n\nexport interface AbstractPayment {\n    domID: string; // the full ID of the wrapper div for the payment control\n}\n\nexport interface CashtipprApiRes {\n    error: boolean;\n    errorMsg: string;\n    data: any[];\n}\n\nexport class CashTippr {\n    protected static readonly CONSENT_COOKIE_NAME = \"ct-ck\";\n    protected static readonly CONFIRM_COOKIES_MSG = \"#ct-cookieMsg\";\n    protected static readonly CONFIRM_COOKIES_BTN = \"#ct-confirmCookies\";\n    // TODO separate entryPoints + classes for admin + public code? but tooltips and other admin stuff can be used publicly too (and is quite small)\n\n    public readonly window: Window;\n    public readonly $: JQueryStatic;\n    public readonly badger: BadgerWallet;\n    public readonly qr: QrCode;\n    public readonly blurryImage: BlurryImage;\n    public readonly shout: Shout;\n\n    protected config: CashTipprConfig;\n    protected webHelpers: WebHelpers;\n    protected tooltips = new Tooltips(this);\n\n    constructor(window: Window, $: JQueryStatic) {\n        this.window = window;\n        this.$ = $;\n        this.config = this.window['cashtipprCfg'] || {};\n        this.config.consentCookieName = CashTippr.CONSENT_COOKIE_NAME;\n        this.config.confirmCookiesMsg = CashTippr.CONFIRM_COOKIES_MSG;\n        this.config.confirmCookiesBtn = CashTippr.CONFIRM_COOKIES_BTN;\n\n        this.webHelpers = new WebHelpers(this.window, this.$, this.config);\n        this.badger = new BadgerWallet(this, this.webHelpers, true);\n        this.qr = new QrCode(this, this.webHelpers);\n        this.blurryImage = new BlurryImage(this);\n        this.shout = new Shout(this);\n        this.$(this.window.document).ready(($) => {\n            this.tooltips.initToolTips();\n            this.webHelpers.checkCookieConsent();\n        });\n    }\n\n    public static toSatoshis(bch: number) {\n        return Math.floor(bch * 100000000);\n    }\n\n    public getConfig() {\n        return this.config;\n    }\n\n    public getWebHelpers() {\n        return this.webHelpers;\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n}","import {CashTippr} from \"./src/CashTippr\";\n\nlet cashtippr = new CashTippr(window, jQuery);\n(window as any).cashtippr = cashtippr;","import {CashTippr} from \"../CashTippr\";\n\nexport class Tooltips {\n    protected cashtippr: CashTippr;\n\n    constructor(cashtippr: CashTippr) {\n        this.cashtippr = cashtippr;\n    }\n\n    /**\n     * Initializes status bar hover entries.\n     */\n    public initToolTips() {\n        const window = this.cashtippr.window;\n        const jQuery = this.cashtippr.$;\n        const that = this;\n        const tsfL10n = { // TODO localization\n            states: {\n                debug: false\n            }\n        }\n\n        let touchBuffer = 0,\n            inTouchBuffer = false;\n\n        const setTouchBuffer = function() {\n            inTouchBuffer = true;\n            clearTimeout( touchBuffer );\n            touchBuffer = setTimeout( function() {\n                inTouchBuffer = false;\n            }, 250 );\n        }\n\n        const setEvents = function( target, unset = false ) {\n\n            unset = unset || false;\n\n            let touchEvents = 'pointerdown.tsfTT touchstart.tsfTT click.tsfTT',\n                $target = jQuery( target );\n\n            if ( unset ) {\n                $target.off( 'mousemove mouseleave mouseout ct-tooltip-update' );\n                jQuery( document.body ).off( touchEvents );\n            } else {\n                $target.on( {\n                    'mousemove'  : mouseMove,\n                    'mouseleave' : mouseLeave,\n                    'mouseout'   : mouseLeave,\n                } );\n                jQuery( document.body ).off( touchEvents ).on( touchEvents, touchRemove );\n            }\n\n            $target.on( 'ct-tooltip-update', updateDesc );\n        }\n        const unsetEvents = function( target ) {\n            setEvents( target, true );\n        }\n        const updateDesc = function( event ) {\n            if ( event.target.classList.contains( 'ct-tooltip-item' ) ) {\n                let tooltipText = event.target.querySelector( '.ct-tooltip-text' );\n                if ( tooltipText instanceof Element )\n                    tooltipText.innerHTML = event.target.dataset.desc;\n            }\n        }\n        const mouseEnter = function( event ) {\n            let $hoverItem = jQuery( event.target ),\n                desc = event.target.dataset.desc;\n\n            if ( desc && 0 === $hoverItem.find( 'div' ).length ) {\n                //= Remove any titles attached.\n                event.target.title = \"\";\n\n                let $tooltip = jQuery(\n                    '<div class=\"ct-tooltip\"><span class=\"ct-tooltip-text-wrap\"><span class=\"ct-tooltip-text\">'\n                    + desc +\n                    '</span></span><div class=\"ct-tooltip-arrow\"></div></div>'\n                );\n                $hoverItem.append( $tooltip );\n\n                let $boundary = $hoverItem.closest( '.ct-tooltip-boundary' );\n                $boundary = $boundary.length && $boundary || jQuery( document.body );\n\n                //= 9 = arrow (8) + shadow (1)\n                let tooltipHeight = $hoverItem.outerHeight() + 9,\n                    tooltipTop = $tooltip.offset().top - tooltipHeight,\n                    boundaryTop = $boundary.offset().top - ( $boundary.prop( 'scrolltop' ) || 0 );\n\n                if ( boundaryTop > tooltipTop ) {\n                    $tooltip.addClass( 'ct-tooltip-down' );\n                    $tooltip.css( 'top', tooltipHeight + 'px' );\n                } else {\n                    $tooltip.css( 'bottom', tooltipHeight + 'px' );\n                }\n\n                let $hoverItemWrap = $hoverItem.closest( '.ct-tooltip-wrap' ),\n                    $textWrap = $tooltip.find( '.ct-tooltip-text-wrap' ),\n                    $innerText = $textWrap.find( '.ct-tooltip-text' ),\n                    hoverItemWrapWidth = $hoverItemWrap.width(),\n                    textWrapWidth = $textWrap.outerWidth( true ),\n                    textWidth = $innerText.outerWidth( true ),\n                    textLeft = $textWrap.offset().left,\n                    textRight = textLeft + textWidth,\n                    boundaryLeft = $boundary.offset().left - ( $boundary.prop( 'scrollLeft' ) || 0 ),\n                    boundaryRight = boundaryLeft + $boundary.outerWidth();\n\n                //= RTL and LTR are normalized to abide to left.\n                let direction = 'left';\n\n                if ( textLeft < boundaryLeft ) {\n                    //= Overflown over left boundary (likely window)\n                    //= Add indent relative to boundary. 24px width of arrow / 2 = 12 middle\n                    let horIndent = boundaryLeft - textLeft + 12,\n                        basis = parseInt( $textWrap.css( 'flex-basis' ), 10 );\n\n                    /**\n                     * If the overflow is greater than the tooltip flex basis,\n                     * the tooltip was grown. Shrink it back to basis and use that.\n                     */\n                    if ( horIndent < -basis )\n                        horIndent = -basis;\n\n                    $tooltip.css( direction, horIndent + 'px' );\n                    $tooltip.data( 'overflow', horIndent );\n                    $tooltip.data( 'overflowDir', direction );\n                } else if ( textRight > boundaryRight ) {\n                    //= Overflown over right boundary (likely window)\n                    //= Add indent relative to boundary. Add 12px for visual appeal.\n                    let horIndent = boundaryRight - textRight - hoverItemWrapWidth - 12,\n                        basis = parseInt( $textWrap.css( 'flex-basis' ), 10 );\n\n                    /**\n                     * If the overflow is greater than the tooltip flex basis,\n                     * the tooltip was grown. Shrink it back to basis and use that.\n                     */\n                    if ( horIndent < -basis )\n                        horIndent = -basis;\n\n                    $tooltip.css( direction, horIndent + 'px' );\n                    $tooltip.data( 'overflow', horIndent );\n                    $tooltip.data( 'overflowDir', direction );\n                } else if ( hoverItemWrapWidth < 42 ) {\n                    //= Small tooltip container. Add indent to make it visually appealing.\n                    let indent = -15;\n                    $tooltip.css( direction, indent + 'px' );\n                    $tooltip.data( 'overflow', indent );\n                    $tooltip.data( 'overflowDir', direction );\n                } else if ( hoverItemWrapWidth > textWrapWidth ) {\n                    //= Wrap is bigger than tooltip. Adjust accordingly.\n                    let pagex = event.originalEvent && event.originalEvent.pageX || event.pageX, // iOS touch support,\n                        hoverItemLeft = $hoverItemWrap.offset().left,\n                        center = pagex - hoverItemLeft,\n                        left = center - textWrapWidth / 2,\n                        right = left + textWrapWidth;\n\n                    if ( left < 0 ) {\n                        //= Don't overflow left.\n                        left = 0;\n                    } else if ( right > hoverItemWrapWidth ) {\n                        //= Don't overflow right.\n                        //* Use textWidth instead of textWrapWidth as it gets squashed in flex.\n                        left = hoverItemWrapWidth - textWidth;\n                    }\n\n                    $tooltip.css( direction, left + 'px' );\n                    $tooltip.data( 'adjust', left );\n                    $tooltip.data( 'adjustDir', direction );\n                }\n            }\n        }\n        const mouseMove = function( event ) {\n            let $target = jQuery( event.target ),\n                $tooltip = $target.find( '.ct-tooltip' ),\n                $arrow = $tooltip.find( '.ct-tooltip-arrow' ),\n                overflow = $tooltip.data( 'overflow' ),\n                overflowDir = $tooltip.data( 'overflowDir' );\n\n            overflow = parseInt( overflow, 10 );\n            overflow = isNaN( overflow ) ? 0 : - Math.round( overflow );\n\n            if ( overflow ) {\n                //= Static arrow based on static overflow.\n                $arrow.css( overflowDir, overflow + \"px\" );\n            } else {\n                let pagex = event.originalEvent && event.originalEvent.pageX || event.pageX, // iOS touch support\n                    arrowBoundary = 7,\n                    arrowWidth = 16,\n                    $hoverItemWrap = $target.closest( '.ct-tooltip-wrap' ),\n                    mousex = pagex - $hoverItemWrap.offset().left - arrowWidth / 2,\n                    originalMousex = mousex,\n                    $textWrap = $tooltip.find( '.ct-tooltip-text-wrap' ),\n                    textWrapWidth = $textWrap.outerWidth( true ),\n                    adjust = $tooltip.data( 'adjust' ),\n                    adjustDir = $tooltip.data( 'adjustDir' ),\n                    boundaryRight = textWrapWidth - arrowWidth - arrowBoundary;\n\n                //= mousex is skewed, adjust.\n                adjust = parseInt( adjust, 10 );\n                adjust = isNaN( adjust ) ? 0 : Math.round( adjust );\n                if ( adjust ) {\n                    adjust = 'left' === adjustDir ? -adjust : adjust;\n                    mousex = mousex + adjust;\n\n                    //= Use textWidth for right boundary if adjustment exceeds.\n                    if ( boundaryRight - adjust > $hoverItemWrap.outerWidth( true ) ) {\n                        let $innerText = $textWrap.find( '.ct-tooltip-text' ),\n                            textWidth = $innerText.outerWidth( true );\n                        boundaryRight = textWidth - arrowWidth - arrowBoundary;\n                    }\n                }\n\n                if ( mousex <= arrowBoundary ) {\n                    //* Overflown left.\n                    $arrow.css( 'left', arrowBoundary + \"px\" );\n                } else if ( mousex >= boundaryRight ) {\n                    //* Overflown right.\n                    $arrow.css( 'left', boundaryRight + \"px\" );\n                } else {\n                    //= Somewhere in the middle.\n                    $arrow.css( 'left', mousex + \"px\" );\n                }\n            }\n        }\n        const mouseLeave = function( event ) {\n\n            //* @see touchMove\n            if ( inTouchBuffer )\n                return;\n\n            jQuery( event.target ).find( '.ct-tooltip' ).remove();\n            unsetEvents( event.target );\n        }\n        /**\n         * ^^^\n         * These two methods conflict eachother in EdgeHTML.\n         * Thusly, touch buffer.\n         * vvv\n         */\n        const touchRemove = function( event ) {\n\n            //* @see mouseLeave\n            setTouchBuffer();\n\n            let itemSelector = '.ct-tooltip-item',\n                balloonSelector = '.ct-tooltip';\n\n            let $target = jQuery( event.target ),\n                $keepBalloon;\n\n            if ( $target.hasClass( 'ct-tooltip-item' ) ) {\n                $keepBalloon = $target.find( balloonSelector );\n            }\n            if ( ! $keepBalloon ) {\n                let $children = $target.children( itemSelector );\n                if ( $children.length ) {\n                    $keepBalloon = $children.find( balloonSelector );\n                }\n            }\n\n            if ( $keepBalloon && $keepBalloon.length ) {\n                //= Remove all but this.\n                jQuery( balloonSelector ).not( $keepBalloon ).remove();\n            } else {\n                //= Remove all.\n                jQuery( balloonSelector ).remove();\n            }\n        }\n\n        /**\n         * Loads tooltips within wrapper.\n         * @function\n         */\n        const loadToolTip = function( event ) {\n\n            if ( inTouchBuffer )\n                return;\n\n            let isTouch = false;\n\n            switch ( event.type ) {\n                case 'mouseenter' :\n                    //= Most likely, thus placed first.\n                    break;\n\n                case 'pointerdown' :\n                case 'touchstart' :\n                    isTouch = true;\n                    break;\n\n                default :\n                    break;\n            }\n\n            if ( event.target.classList.contains( 'ct-tooltip-item' ) ) {\n                //= Removes previous items and sets buffer.\n                isTouch && touchRemove( event );\n\n                mouseEnter( event );\n                //= Initiate placement directly for Windows Touch or when overflown.\n                mouseMove( event );\n\n                setEvents( event.target );\n            } else {\n                //= Delegate or bubble, and go back to this method with the correct item.\n                let item = event.target.querySelector( '.ct-tooltip-item:hover' ),\n                    _event = new jQuery.Event( event.type );\n\n                _event.pageX = event.originalEvent && event.originalEvent.pageX || event.pageX;\n\n                if ( item ) {\n                    if ( tsfL10n.states.debug ) console.log( 'Tooltip event warning: delegation' );\n                    jQuery( item ).trigger( _event );\n                } else {\n                    if ( tsfL10n.states.debug ) console.log( 'Tooltip event warning: bubbling' );\n                    jQuery( event.target ).closest( '.ct-tooltip-wrap' ).find( '.ct-tooltip-item:hover' ).trigger( _event );\n                }\n            }\n\n            //* Stop further propagation.\n            event.stopPropagation();\n        }\n\n        /**\n         * Initializes tooltips.\n         * @function\n         */\n        const initTooltips = function() {\n            let $wrap = jQuery( '.ct-tooltip-wrap' );\n\n            $wrap.off( 'mouseenter pointerdown touchstart' );\n            $wrap.on( 'mouseenter pointerdown touchstart', '.ct-tooltip-item', loadToolTip );\n        }\n        initTooltips();\n        jQuery( window ).on( 'ct-reset-tooltips', initTooltips );\n\n        (function() {\n            let e = jQuery( '#wpcontent' );\n            that.addTooltipBoundary( e );\n        })();\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    /**\n     * Adds tooltip boundaries.\n     */\n    protected addTooltipBoundary( e ) {\n        jQuery( e ).addClass( 'ct-tooltip-boundary' );\n    }\n\n    /**\n     * Triggers tooltip reset.\n     */\n    protected _triggerTooltipReset() { // not used yet\n        jQuery( window ).trigger( 'ct-reset-tooltips' );\n    }\n\n    /**\n     * Triggers active tooltip update.\n     */\n    protected _triggerTooltipUpdate(item) { // not used yet\n        jQuery( item ).trigger( 'ct-tooltip-update' );\n    }\n}","\nexport interface WebHelpersConfig {\n    cookieLifeDays: number;\n    cookiePath: string;\n    siteUrl: string;\n\n    // DOM ids of elements of cookie consent message\n    consentCookieName: string;\n    confirmCookiesMsg: string;\n    confirmCookiesBtn: string;\n}\n\nexport class WebHelpers {\n    public readonly window: Window;\n    public readonly $: JQueryStatic;\n\n    protected config: WebHelpersConfig;\n\n    constructor(window: Window, $: JQueryStatic, config: WebHelpersConfig) {\n        this.window = window;\n        this.$ = $;\n        this.config = config;\n    }\n\n    public getBrowserLang() {\n        return this.window.navigator.language.substr(0, 2).toLowerCase();\n    }\n\n    public getCookie(c_name: string) {\n        let i, x, y;\n        let ARRcookies = this.window.document.cookie.split(\";\");\n        for (i = 0; i < ARRcookies.length; i++)\n        {\n            x = ARRcookies[i].substr(0, ARRcookies[i].indexOf(\"=\"));\n            y = ARRcookies[i].substr(ARRcookies[i].indexOf(\"=\") + 1);\n            x = x.replace(/^\\s+|\\s+$/g,\"\");\n            if (x == c_name)\n                return decodeURI(y);\n        }\n        return null;\n    }\n\n    public setCookie(name: string, value: any, expireDays: number) {\n        let date = new Date();\n        date = new Date(date.getTime()+1000*60*60*24* (expireDays ? expireDays : this.config.cookieLifeDays));\n        //document.cookie = name + \"=\" + value + \"; expires=\" + date.toGMTString() + \"; path=\" + pageData.cookiePath + \"; domain=.\" + location.host;\n        this.window.document.cookie = name + \"=\" + value + \"; expires=\" + date.toUTCString() + \"; path=\" + this.config.cookiePath;\n    }\n\n    public removeCookie(name: string) {\n        //document.cookie = name + \"=; expires=Thu, 02 Jan 1970 00:00:00 UTC; path=\" + pageData.cookiePath + \"; domain=.\" + location.host;\n        this.window.document.cookie = name + \"=; expires=Thu, 02 Jan 1970 00:00:00 UTC; path=\" + this.config.cookiePath;\n    }\n\n    public checkCookieConsent() {\n        this.$(this.config.confirmCookiesBtn).click(() => {\n            this.confirmCookies();\n        });\n        if (this.getCookie(this.config.consentCookieName) !== null)\n            this.$(this.config.confirmCookiesMsg).remove(); // we recently showed the cookie confirm message. some pages might still be in browser cache\n    }\n\n    public fromBase64(data: string) {\n        if (typeof this.window.atob !== \"function\") {\n            this.window.console.error(\"Base64 decoding is not supported in your browser\");\n            return \"\";\n        }\n        return this.window.atob(data);\n    }\n\n    public toBase64(data: string) {\n        if (typeof this.window.btoa !== \"function\") {\n            this.window.console.error(\"Base64 encoding is not supported in your browser\");\n            return \"\";\n        }\n        return this.window.btoa(data);\n    }\n\n    /**\n     * Populate a html template\n     * @param text {String}: The html template (or just normal text with variables)\n     * @param variables {Object}: the key-value pairs with variables names and their content to be set in text\n     * @param safeHtml {boolean, default false}: don't escape html characters if set to true\n     * @returns {String} the translated html\n     */\n    public translate(text: string, variables: any, safeHtml: boolean = false) {\n        if (typeof text !== \"string\") {\n            try {\n                // @ts-ignore\n                text = text.toString();\n            }\n            catch (e) {\n                this.log(\"Text to translate is not a string\");\n                return text;\n            }\n        }\n        let start = 0, end = 0;\n        while ((start = text.indexOf(\"{\", start)) !== -1)\n        {\n            if (start > 0 && text.charAt(start-1) === \"\\\\\") { // escaped javascript code beginning\n                start++;\n                continue;\n            }\n            end = text.indexOf(\"}\", start);\n            if (end === -1) {\n                this.log(\"Can not find end position while translating HTML\");\n                break;\n            }\n            let placeHolder = text.substring(start+1, end);\n            let translation = null;\n            if (placeHolder.substring(0, 3) === \"tr:\") {\n                let key = placeHolder.substring(3);\n                //translation = this.tr(key.toUpperCase());\n                translation = this.tr(key);\n            }\n            else if (typeof variables === \"object\") {\n                let textPiece = variables[placeHolder];\n                if (typeof textPiece !== \"undefined\") {\n                    if (typeof safeHtml === \"boolean\" && safeHtml)\n                        translation = textPiece;\n                    else\n                        translation = this.escapeOutput(textPiece);\n                }\n            }\n            if (translation !== null) {\n                let reg = new RegExp(\"\\\\{\" + placeHolder + \"\\\\}\", \"g\");\n                text = text.replace(reg, translation);\n            }\n            else if (placeHolder.match(\"[A-Za-z0-9_]+\") !== null) {\n                this.log(\"No translation found for place holder: \" + placeHolder);\n                let reg = new RegExp(\"\\\\{\" + placeHolder + \"\\\\}\", \"g\");\n                text = text.replace(reg, \"MISSING: \" + this.escapeOutput(placeHolder));\n            }\n            else\n                start += placeHolder.length;\n        }\n        text = text.replace(/\\\\\\\\\\\\{/, \"{\");\n        return text;\n    }\n\n    public escapeOutput(text: string, convertNewlines: boolean = true) {\n        if (typeof text !== \"string\")\n            return text;\n        text = text.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#039;\");\n        if (typeof convertNewlines === \"undefined\" || convertNewlines === true)\n            text = text.replace(/\\r?\\n/g, \"<br>\");\n        return text;\n    }\n\n    public escapeRegex(str: string) {\n        return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n    }\n\n    public tr(key: string) {\n        //if (typeof language[key] === \"undefined\")\n        //return \"MISSING: \" + key;\n        //return language[key];\n        //return i18next.t(key) // will just print the key if it doesn't exist and debug is disabled\n        return key; // we don't have client-side translation support on this WP plugin yet. just return the key // TODO do we need this if we make our plugin use more ajax?\n    }\n\n    public log(args) {\n        if (//typeof pageData.debugLog !== \"boolean\" || pageData.debugLog === false || // TODO add in CashTipprConfig\n            typeof this.window.console !== \"object\" || typeof this.window.console.log !== \"function\")\n            return;\n        this.window.console.log(arguments);\n    }\n\n    public isAppleIOS() {\n        // https://stackoverflow.com/questions/9038625/detect-if-device-is-ios\n        return /iPad|iPhone|iPod/.test(this.window.navigator.userAgent) && !(this.window as any).MSStream;\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected confirmCookies() {\n        /* // no data stored in session\n        this.getApi('/json/cookies', function(data) {\n            if (data.error)\n                //Hlp.showMsg(i18next.t('errorSending'), 'danger');\n                console.error(\"Error sending data\");\n            else {\n            }\n        })\n        */\n        this.$(this.config.confirmCookiesMsg).remove();\n        this.setCookie(this.config.consentCookieName, \"1\", this.config.cookieLifeDays);\n    }\n\n    public getApi(path: string, data?: any, callback?: (data: any, textStatus: string, jqXHR: JQueryXHR) => any, dataType?: string) {\n        if (typeof data === \"function\") {\n            callback = data;\n            data = null;\n        }\n        else if (data === undefined)\n            data = null;\n        let url = path;\n        if (url.toLowerCase().indexOf(\"http\") !== 0)\n            url = this.config.siteUrl + url;\n        return this.$.get(url, data, (data, textStatus, jqXHR) => {\n            callback(data, textStatus, jqXHR);\n        }, dataType);\n    }\n}","import {CashTippr} from \"./CashTippr\";\n\n/**\n * The class for displaying blurry images.\n * We bundle it together with all our JavaScript instead of with the addon because\n * a 2nd JS WebPack project would create unnecessary dependency + bootstrap overhead.\n */\nexport class BlurryImage {\n    protected cashtippr: CashTippr;\n\n    constructor(cashtippr: CashTippr) {\n        this.cashtippr = cashtippr;\n        // TODO implement events this class (and other addons) can listen to so that we don't have to call functions in here directly\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n}","import {AbstractPayment, CashTippr} from \"./CashTippr\";\n\n/**\n * The class for displaying the shout addon.\n * We bundle it together with all our JavaScript instead of with the addon because\n * a 2nd JS WebPack project would create unnecessary dependency + bootstrap overhead.\n */\nexport class Shout {\n    protected cashtippr: CashTippr;\n    protected scheduleUpdateTimerID = 0;\n\n    constructor(cashtippr: CashTippr) {\n        this.cashtippr = cashtippr;\n        // TODO implement events this class (and other addons) can listen to so that we don't have to call functions in here directly\n        this.cashtippr.$(this.cashtippr.window.document).ready(($) => {\n            if (this.cashtippr.$(\".ct-message\").length !== 0) {\n                this.updateRemainingChars();\n                this.addEventListeners();\n            }\n        });\n\n        // admin area\n        this.cashtippr.$(this.cashtippr.window.document).ready(($) => {\n            this.addConfirmDeleteMessages();\n        })\n    }\n\n    public onPayment(payment: AbstractPayment) {\n        this.cashtippr.$(\"#\" + payment.domID).parent().parent().submit();\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected updateRemainingChars() {\n        const forms = this.cashtippr.$(\".ct-message\").parent().parent();\n        this.cashtippr.$.each(forms, (index, value) => {\n            const formEl = this.cashtippr.$(value);\n            let text = formEl.find(\".ct-message\").val();\n            let maxChars = parseInt(formEl.find(\".ct-max-chars\").val());\n            const remaining = maxChars - text.length;\n            formEl.find(\".ct-chars-left\").text(remaining);\n            if (remaining < 0) {\n                formEl.find(\".ct-chars-left\").css(\"color\", \"red\");\n                formEl.find(\".ct-shout\").prop(\"disabled\", true);\n                formEl.find(\".ct-button\").fadeOut(\"slow\");\n            }\n            else {\n                formEl.find(\".ct-chars-left\").css(\"color\", \"\");\n                if (text.length === 0) { // don't let the user submit empty messages\n                    formEl.find(\".ct-shout\").prop(\"disabled\", true);\n                    formEl.find(\".ct-button\").fadeOut(\"slow\");\n                }\n                else {\n                    formEl.find(\".ct-shout\").prop(\"disabled\", false);\n                    formEl.find(\".ct-button\").fadeIn(\"slow\");\n                }\n            }\n        });\n    }\n\n    protected addEventListeners() {\n        this.cashtippr.$(\".ct-message\").keyup((event) => {\n            this.scheduleCharsUpdate();\n        });\n        this.cashtippr.$(\".ct-message\").change((event) => {\n            this.scheduleCharsUpdate();\n        });\n    }\n\n    protected addConfirmDeleteMessages() {\n        this.cashtippr.$(\".ct-delete-shout-link\").on(\"click\", (event) => {\n            const question = this.cashtippr.$(\"#ct-delete-shout-confirm\").text();\n            if (this.cashtippr.window.confirm(question) === true)\n                return;\n            event.preventDefault();\n            return false; // should't be needed anymore in 2018\n        });\n    }\n\n    protected scheduleCharsUpdate() {\n        if (this.scheduleUpdateTimerID !== 0)\n            clearTimeout(this.scheduleUpdateTimerID);\n        this.scheduleUpdateTimerID = setTimeout(() => {\n            this.updateRemainingChars();\n        }, 50);\n    }\n}","import {AbstractPayment, CashTippr, CashtipprApiRes} from \"./CashTippr\";\nimport {WebHelpers} from \"./WebHelpers\";\n\n\nexport class QrCode {\n    protected cashtippr: CashTippr;\n    protected webHelpers: WebHelpers;\n\n    constructor(cashtippr: CashTippr, webHelpers: WebHelpers) {\n        this.cashtippr = cashtippr;\n        this.webHelpers = webHelpers;\n\n        this.cashtippr.$(this.cashtippr.window.document).ready(($) => {\n            this.cashtippr.$(\".ct-qrcode-btn\").click((event) => {\n                this.showQrDialog(event.target);\n            });\n        });\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected showQrDialog(target: Element) {\n        const paymentButtonlWrapper = this.cashtippr.$(target).parent().parent().parent();\n        const txid = paymentButtonlWrapper.attr(\"id\").replace(/^ct-btn-wrap-/, \"\");\n        const paymentCtrlWrapper = paymentButtonlWrapper.parent();\n        let amount = 0.0;\n        if (paymentCtrlWrapper.find(\"input[name='amount']\").length !== 0)\n            amount = paymentCtrlWrapper.find(\"input[name='amount']\").val(); // custom editable amount by user\n        let params = {\n            txid: txid,\n            am: amount\n        }\n        let dialog = this.webHelpers.translate(this.cashtippr.$(\"#ct-modal-qrcode-dialog-tpl\").html(), {\n            dialog_class: \"dialog-\" + txid\n        });\n        this.cashtippr.$(\"body\").append(dialog); // its position is fixed relative to the viewport\n\n        this.webHelpers.getApi(\"/wp-json/cashtippr/v1/qrcode\", params, (data) => {\n            this.cashtippr.$(\".ct-loading\").remove();\n            if (data.error === true) {\n                this.cashtippr.window.console.error(\"Error starting QR code tip\");\n                this.cashtippr.window.console.error(data.errorMsg);\n                return;\n            }\n            this.cashtippr.$(\".ct-qr-code\").fadeIn(\"slow\").attr(\"src\", data.data[0]);\n        });\n\n        this.cashtippr.$(\".ct-close-dialog\").click((event) => {\n            this.cashtippr.$(\".dialog-\" + txid).remove();\n        });\n        this.cashtippr.$(\".ct-copy-field\").click((event) => {\n            const inputEl = this.cashtippr.$(event.target).parent().find(\"input[type='text']\");\n            //let text = inputEl.val();\n            inputEl.select();\n            try {\n                this.cashtippr.window.document.execCommand(\"copy\");\n            }\n            catch (err) { // try-catch shouldn't be needed except for some really old browsers\n            }\n            inputEl.select(); // ensure it's selected again for iOS devices to copy it manually. not working, remove?\n        });\n        this.cashtippr.$(\"#ct-qrcode-form input[type='text']\").click((event) => {\n            this.cashtippr.$(event.target).select();\n        });\n        if (this.webHelpers.isAppleIOS() === true) // copy to clipboard button doesn't work there\n            this.cashtippr.$(\"#ct-qrcode-form .ct-copy-field\").addClass(\"hidden\");\n    }\n}","import {AbstractPayment, CashTippr, CashtipprApiRes} from \"./CashTippr\";\nimport {WebHelpers} from \"./WebHelpers\";\n\nexport interface BadgerWalletPayment extends AbstractPayment {\n    buttonId: string; // unique ID, tx ID in our case\n    txid: string;\n    amount: string;\n    currency: string;\n    buttonData: string; // JSON string \"{}\" or base64 data in our app\n    buttonDataObj: any; // unserialized JS object from buttonData\n}\n\nexport class BadgerWallet {\n    protected cashtippr: CashTippr;\n    protected webHelpers: WebHelpers;\n    protected globalCallbacks: boolean; // expose callback functions to window object because BadgerButton currently doesn't support functions on objects\n\n    constructor(cashtippr: CashTippr, webHelpers: WebHelpers, globalCallbacks = false) {\n        this.cashtippr = cashtippr;\n        this.webHelpers = webHelpers;\n        this.globalCallbacks = globalCallbacks;\n\n        if (this.globalCallbacks === true) {\n            setTimeout(() => { // must be done after constructor or else functions are undefined\n                this.cashtippr.window['onBadgerPayment'] = this.onBadgerPayment;\n                this.cashtippr.window['onBadgerClientPayment'] = this.sendPaymentReceived;\n            }, 0);\n        }\n\n        this.cashtippr.$(this.cashtippr.window.document).ready(($) => {\n            this.cashtippr.$(\".ct-input-amount\").keyup((event) => {\n                this.updateButtonAmount(event.target);\n            });\n            this.cashtippr.$(\".ct-input-amount\").change((event) => {\n                this.updateButtonAmount(event.target);\n            });\n        });\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected onBadgerPayment(payment: BadgerWalletPayment) {\n        if (typeof payment.buttonData === \"string\" && payment.buttonData.length !== 0 && payment.buttonData[0] !== \"{\")\n            payment.buttonDataObj = JSON.parse(this.cashtippr.getWebHelpers().fromBase64(payment.buttonData)) || {}; // this.webHelpers is undefined\n        if (payment.domID === undefined)\n            payment.domID = \"ct-btn-wrap-\" + payment.buttonId;\n        //console.log(\"Badger Payment\", payment);\n\n        // TODO make an ajax call to WP to check if the payment has actually been received (will an extension support some webhook callback? likely not)\n        // then depending on if the content is hidden with CSS: modify style or reload page (server can tell this, or we add a variable)\n        // simply always remove the style\n        if (this.cashtippr.getConfig().show_search_engines === true) {\n            //this.cashtippr.$(\".ct-hidden-text\").css(\"cssText\", \"display: inherit!important;\");\n            // especially with editable + hidden button on same page\n\n            if (!payment.buttonDataObj || payment.buttonDataObj.days !== 0) { // show everything for full passes\n                this.cashtippr.$(\".ct-hidden-text\").fadeIn(\"slow\");\n                this.cashtippr.$(\".ct-more, .ct-button-text, .ct-image-blurry\").fadeOut(\"slow\");\n            }\n            else { // only show the contents hidden in this button\n                this.cashtippr.$(\"#ct-hidden-\" + payment.buttonId).fadeIn(\"slow\");\n                this.cashtippr.$(\"#ct-button-text-\" + payment.buttonId + \", #ct-image-blurry-\" + payment.buttonId).fadeOut(\"slow\");\n                if (payment.buttonDataObj.postHide === true) // auto hide of the full post. there can only be 1 such element\n                    this.cashtippr.$(\".ct-more\").fadeOut(\"slow\");\n            }\n            //this.sendPaymentReceived(payment);\n            this.cashtippr.window['onBadgerClientPayment'].call(this.cashtippr.badger, payment, (res: CashtipprApiRes) => {\n                if (payment.buttonDataObj && payment.buttonDataObj.shout === true)\n                    this.cashtippr.shout.onPayment(payment);\n            });\n            // TODO increment tips received and donation goal progress with JS\n            if (typeof this.cashtippr.window['onCashtipprPayment'] === \"function\")\n                this.cashtippr.window['onCashtipprPayment'].call(this.cashtippr.window, {badger: payment});\n            return;\n        }\n\n        this.cashtippr.window['onBadgerClientPayment'].call(this.cashtippr.badger, payment, (res: CashtipprApiRes) => {\n            if (payment.buttonDataObj && payment.buttonDataObj.shout === true) {\n                this.cashtippr.shout.onPayment(payment);\n                return; // this will already reload the page\n            }\n            // TODO add random query param to bypass caching? look at different WP caching plugins first\n            // some might ignore query strings\n            // better way would be to implement WP hooks to bypass cache for paid users (if provided by cache plugins)\n            // to make it work with full-page caching we have to fetch params such as TXID via ajax either way\n            this.cashtippr.window.location.reload(true);\n        });\n    }\n\n    protected sendPaymentReceived(payment: BadgerWalletPayment, callback?: (res: CashtipprApiRes) => void) {\n        let params = {\n            txid: payment.buttonId,\n            am: payment.amount\n        }\n        this.webHelpers.getApi(\"/wp-json/cashtippr/v1/mb-client\", params, (data) => {\n            callback && callback(data);\n        });\n    }\n\n    protected updateButtonAmount(target: Element) {\n        const btnContainer = this.cashtippr.$(target).parent().parent();\n        const btn = btnContainer.find(\".badger-button\");\n        if (!btn) {\n            this.cashtippr.window.console.error(\"Unable to find Badger button\", btnContainer);\n            return;\n        }\n        const amountNewUserCurrency = parseFloat(this.cashtippr.$(target).val());\n        if (amountNewUserCurrency === 0.0 || amountNewUserCurrency === Number.NaN)\n            return;\n        const currency = this.cashtippr.getConfig().display_currency;\n        const amountSats = CashTippr.toSatoshis(amountNewUserCurrency / this.cashtippr.getConfig().rate[currency]);\n        btn.attr(\"data-satoshis\", amountSats);\n        btn.find(\".ct-btn-display-amount\").text(amountNewUserCurrency);\n    }\n}"],"sourceRoot":""}